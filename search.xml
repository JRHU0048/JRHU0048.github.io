<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>MATLAB制图</title>
      <link href="/2024/04/25/matlab-zhi-tu/"/>
      <url>/2024/04/25/matlab-zhi-tu/</url>
      
        <content type="html"><![CDATA[<h2 id="常见的MATLAB制图代码集合"><a href="#常见的MATLAB制图代码集合" class="headerlink" title="常见的MATLAB制图代码集合"></a>常见的MATLAB制图代码集合</h2><p>area函数是Y轴数值对 x 坐标轴围成的面积图，该函数根据Y的形状填充曲线之间的区域。</p><p>fill函数是创建二维填充补片（patch），即填充多边形区域绘制为补片，其顶点位于由X和Y指定的(x,y)坐标位置，主要用于平面中多个区域的颜色填充。</p><p>patch函数是创建彩色多边形的补片，即按X和Y指定为每个顶点的坐标创建一个或多个彩色多边形补片，主要用于平面中多边形的颜色填充。</p><p>patch与fill函数功能和用法类似。area函数主要针对与坐标轴围成的区域的填充，如果需要对图形窗口内任意闭合区域或多边形区域及进行填充，则需要用到fill和patch函数。</p><p><img src="https://pic.imgdb.cn/item/662a276d0ea9cb1403757781.jpg" alt="alt text"></p><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">clc; clear; close <span class="built_in">all</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">% 数据</span></span><br><span class="line">x <span class="built_in">=</span> linspace(-<span class="number">8</span>,<span class="number">12</span>,<span class="number">100</span>);</span><br><span class="line">y1 <span class="built_in">=</span> normpdf(x,<span class="number">4</span>,<span class="number">6</span>);<span class="comment">% Normal probability density function</span></span><br><span class="line">y2 <span class="built_in">=</span> normpdf(x,<span class="number">0</span>,<span class="number">1</span>).*<span class="number">0.5</span>+normpdf(x,<span class="number">4</span>,<span class="number">2</span>).*<span class="number">0.5</span>;</span><br><span class="line">y3 <span class="built_in">=</span> normpdf(x,-<span class="number">3</span>,<span class="number">2</span>);</span><br><span class="line">y <span class="built_in">=</span> [y1;y2;y3];</span><br><span class="line"></span><br><span class="line"><span class="comment">% 颜色</span></span><br><span class="line">c <span class="built_in">=</span> [<span class="number">184</span> <span class="number">194</span> <span class="number">140</span>; <span class="number">201</span> <span class="number">226</span> <span class="number">240</span>; <span class="number">250</span> <span class="number">181</span> <span class="number">157</span>]./<span class="number">255</span>; <span class="comment">% Three colors</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 绘图</span></span><br><span class="line">for i <span class="built_in">=</span> <span class="number">1</span>:size(y,<span class="number">1</span>)</span><br><span class="line">area(x,y(i,:),<span class="string">&#x27;FaceColor&#x27;</span>,c(i,:),<span class="string">&#x27;EdgeColor&#x27;</span>,<span class="string">&#x27;none&#x27;</span>,<span class="string">&#x27;FaceAlpha&#x27;</span>,<span class="number">0.5</span>); hold on</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line"><span class="comment">% 坐标轴</span></span><br><span class="line">xlabel(<span class="string">&#x27;x/Samples&#x27;</span>),ylabel(<span class="string">&#x27;y/Value&#x27;</span>)</span><br><span class="line">legend(&#123;<span class="string">&#x27;- Area No.1&#x27;</span>,<span class="string">&#x27;- Area No.2&#x27;</span>,<span class="string">&#x27;- Area No.3&#x27;</span>&#125;)</span><br><span class="line">set(gca,<span class="string">&#x27;XLim&#x27;</span>,[-<span class="number">8</span> <span class="number">12</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 修饰</span></span><br><span class="line">defaultAxes</span><br></pre></td></tr></table></figure><p><strong>数据生成</strong></p><ol><li><code>x = linspace(-8,12,100);</code><ul><li>生成向量 <code>x</code>，包含从-8到12之间均匀分布的100个点，这些点将用于绘制函数曲线。</li></ul></li></ol><p><strong>计算概率密度函数</strong></p><ol start="2"><li><code>y1 = normpdf(x,4,6);</code><ul><li>计算正态分布PDF，其中均值为4，标准差为6。结果存储在 <code>y1</code> 中。</li></ul></li><li><code>y2 = normpdf(x,0,1).*0.5+normpdf(x,4,2).*0.5;</code><ul><li>计算两个正态分布PDF的线性组合，其中一个均值为0，标准差为1，权重为0.5；另一个均值为4，标准差为2，权重也为0.5。结果合并后存入 <code>y2</code>。</li></ul></li><li><code>y3 = normpdf(x,-3,2);</code><ul><li>计算均值为-3，标准差为2的正态分布PDF，并将其结果保存在 <code>y3</code> 中。</li></ul></li></ol><p><strong>定义颜色</strong></p><ol start="5"><li><code>c = [184 194 140; 201 226 240; 250 181 157]./255;</code><ul><li>定义一个3×3矩阵，包含三组RGB颜色值，分别对应三个分布的填充颜色。这些数值经过除以255的操作，将它们归一化到0到1之间，以便MATLAB能够正确理解。</li></ul></li></ol><p><strong>绘制图形</strong></p><ol start="6"><li><code>for i = 1:size(y,1)</code><ul><li>使用循环结构，遍历 <code>y</code> 的每一行（即每一个分布）。</li></ul></li><li><code>area(x,y(i,:), ...)</code> <ul><li>对于每个分布，调用 <code>area</code> 函数绘制面积图。输入参数为 <code>x</code> 轴坐标向量和对应的 <code>y</code> 值向量。</li></ul></li><li><code>&#39;FaceColor&#39;, c(i,:), &#39;EdgeColor&#39;, &#39;none&#39;, &#39;FaceAlpha&#39;, 0.5</code><ul><li>设置面积图的填充颜色为当前循环索引对应的色彩，边缘颜色为无（即不显示边缘线），并设置填充透明度为0.5，使得底层分布能部分透过上层分布显现。</li></ul></li><li><code>hold on</code><ul><li>在同一张图上保持绘制状态，允许后续循环中的面积图叠加在同一坐标系中。</li></ul></li><li><code>end</code><ul><li>结束循环。</li></ul></li></ol><p><strong>坐标轴与图例</strong></p><ol start="11"><li><code>xlabel(&#39;x/Samples&#39;), ylabel(&#39;y/Value&#39;)</code><ul><li>设置横纵坐标的标签，分别为“x&#x2F;Samples”和“y&#x2F;Value”。</li></ul></li><li><code>legend(&#123;&#39;- Area No.1&#39;, &#39;- Area No.2&#39;, &#39;- Area No.3&#39;&#125;)</code><ul><li>添加图例，标识三个面积区域分别为“Area No.1”、“Area No.2”和“Area No.3”。</li></ul></li></ol><p><strong>坐标轴范围设定</strong></p><ol start="13"><li><code>set(gca, &#39;XLim&#39;, [-8 12])</code><ul><li>设置当前坐标轴（gca）的x轴范围为-8到12，确保图形覆盖指定的x轴区间。</li></ul></li></ol><p><img src="https://pic.imgdb.cn/item/662a2c000ea9cb140382bfbc.jpg" alt="alt text"></p><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 设置参数</span></span><br><span class="line">num_values <span class="built_in">=</span> <span class="number">100</span>;     <span class="comment">% 随机数数量</span></span><br><span class="line">min_value <span class="built_in">=</span> -<span class="number">100</span>;    <span class="comment">% 最小值（包括）</span></span><br><span class="line">max_value <span class="built_in">=</span> <span class="number">100</span>;     <span class="comment">% 最大值（包括）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 生成随机数列表</span></span><br><span class="line">y <span class="built_in">=</span> min_value + (max_value - min_value) * rand(num_values, <span class="number">1</span>);</span><br><span class="line">x <span class="built_in">=</span> linspace(<span class="number">0</span>,<span class="number">100</span>,length(y));</span><br><span class="line">y1 <span class="built_in">=</span> y; y1(y1&lt;<span class="number">0</span>)<span class="built_in">=</span><span class="number">0</span>;      <span class="comment">% 负数</span></span><br><span class="line">y2 <span class="built_in">=</span> y; y2(y2&gt;<span class="number">0</span>)<span class="built_in">=</span><span class="number">0</span>;      <span class="comment">% 正数</span></span><br><span class="line">figure,</span><br><span class="line">area(x,y1,<span class="string">&#x27;FaceColor&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;EdgeColor&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;FaceAlpha&#x27;</span>,<span class="number">0.6</span>); hold on</span><br><span class="line">area(x,y2,<span class="string">&#x27;FaceColor&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;EdgeColor&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;FaceAlpha&#x27;</span>,<span class="number">0.6</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;x-axis/Samples&#x27;</span>),ylabel(<span class="string">&#x27;y-axis/Intensity value&#x27;</span>)</span><br><span class="line">set(gca,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">12</span>)</span><br><span class="line">legend(&#123;<span class="string">&#x27;- Positive value area&#x27;</span>,<span class="string">&#x27;- Negative value area&#x27;</span>&#125;)</span><br><span class="line">set(gcf,<span class="string">&#x27;Color&#x27;</span>,<span class="string">&#x27;White&#x27;</span>);  <span class="comment">%设置背景颜色</span></span><br><span class="line"><span class="comment">% 修饰</span></span><br><span class="line">defaultAxes</span><br></pre></td></tr></table></figure><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 生成随机数列表</span></span><br><span class="line">y <span class="built_in">=</span> min_value + (max_value - min_value) * rand(num_values, <span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>这一行利用Matlab内置函数<code>rand()</code>生成一个<code>num_values</code>行、1列的矩阵，其中元素值为在[0,1]之间均匀分布的随机数。然后将这些随机数乘以<code>(max_value - min_value)</code>得到一个缩放后的范围，并加上<code>min_value</code>，确保最终生成的随机数在<code>[-100, 100]</code>范围内。结果存储在变量<code>y</code>中。</p><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x <span class="built_in">=</span> linspace(<span class="number">0</span>,<span class="number">100</span>,length(y));</span><br></pre></td></tr></table></figure><p>这里使用<code>linspace()</code>函数创建一个等差数列<code>x</code>，起点为0，终点为100，包含的点数与<code>y</code>的长度相同。这意味着<code>x</code>将作为面积图的x轴坐标，与<code>y</code>中的随机数值一一对应。</p><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y1 <span class="built_in">=</span> y; y1(y1&lt;<span class="number">0</span>)<span class="built_in">=</span><span class="number">0</span>;      <span class="comment">% 负数</span></span><br><span class="line">y2 <span class="built_in">=</span> y; y2(y2&gt;<span class="number">0</span>)<span class="built_in">=</span><span class="number">0</span>;      <span class="comment">% 正数</span></span><br></pre></td></tr></table></figure><p>为了分别绘制正负值部分的面积图，创建两个新变量<code>y1</code>和<code>y2</code>。它们最初都复制自<code>y</code>，然后通过逻辑索引将：</p><ul><li><code>y1</code>中所有小于0的值置为0，保留所有负数部分；</li><li><code>y2</code>中所有大于0的值置为0，保留所有正数部分。</li></ul><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">figure,</span><br><span class="line">area(x,y1,<span class="string">&#x27;FaceColor&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;EdgeColor&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;FaceAlpha&#x27;</span>,<span class="number">0.6</span>); hold on</span><br><span class="line">area(x,y2,<span class="string">&#x27;FaceColor&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;EdgeColor&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;FaceAlpha&#x27;</span>,<span class="number">0.6</span>);</span><br></pre></td></tr></table></figure><p>首先打开一个新的图形窗口(<code>figure</code>)，然后使用<code>area()</code>函数绘制面积图：</p><ul><li>第一个面积图基于<code>x</code>和<code>y1</code>，表示负值部分，其填充颜色(<code>FaceColor</code>)和边缘颜色(<code>EdgeColor</code>)均为红色(<code>&#39;r&#39;</code>)，透明度(<code>FaceAlpha</code>)设为0.6；</li><li>第二个面积图基于<code>x</code>和<code>y2</code>，表示正值部分，颜色属性与第一个面积图相同，只是颜色为蓝色(<code>&#39;b&#39;</code>)。</li></ul><p><code>hold on</code>命令确保在同一张图上绘制这两个面积图，不会被自动清空。</p><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xlabel(<span class="string">&#x27;x-axis/Samples&#x27;</span>),ylabel(<span class="string">&#x27;y-axis/Intensity value&#x27;</span>)</span><br><span class="line">set(gca,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">12</span>)</span><br><span class="line">legend(&#123;<span class="string">&#x27;- Positive value area&#x27;</span>,<span class="string">&#x27;- Negative value area&#x27;</span>&#125;)</span><br><span class="line">set(gcf,<span class="string">&#x27;Color&#x27;</span>,<span class="string">&#x27;White&#x27;</span>);  <span class="comment">%设置背景颜色</span></span><br></pre></td></tr></table></figure><p>接下来对图形进行标注和样式调整：</p><ul><li>设置x轴标签为“x-axis&#x2F;Samples”，y轴标签为“y-axis&#x2F;Intensity value”；</li><li>使用<code>set(gca,...)</code>修改当前坐标轴属性，将字体设为“Times New Roman”，字号设为12；</li><li>添加图例，说明两个面积图分别代表“- Positive value area”（正值区域）和“- Negative value area”（负值区域）；</li><li>使用<code>set(gcf,...)</code>设置当前图形窗口的背景颜色为白色。</li></ul><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://mp.weixin.qq.com/s/PJoY5QrlgRGecBStkFiTEQ">https://mp.weixin.qq.com/s/PJoY5QrlgRGecBStkFiTEQ</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2024XCTF4/1-5/1</title>
      <link href="/2024/04/12/2024xctf4-1-5-1/"/>
      <url>/2024/04/12/2024xctf4-1-5-1/</url>
      
        <content type="html"><![CDATA[<h2 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">flag=<span class="string">b&#x27;XYCTF&#123;uuid&#125;&#x27;</span></span><br><span class="line">flag=bytes_to_long(flag)  <span class="comment">#将字节串 flag 转换为大整数</span></span><br><span class="line">leak=<span class="built_in">bin</span>(<span class="built_in">int</span>(flag))   <span class="comment">#转换为二进制字符串的形式</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:       <span class="comment"># 末位补0到514</span></span><br><span class="line">    leak += <span class="string">&quot;0&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(leak) == <span class="number">514</span>:    </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">swap_bits</span>(<span class="params">input_str</span>):   <span class="comment">#交换列表中对应位置的元素</span></span><br><span class="line">    input_list = <span class="built_in">list</span>(input_str[<span class="number">2</span>:])</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">2</span>):</span><br><span class="line">        temp = input_list[i]</span><br><span class="line">        input_list[i] = input_list[length - <span class="number">1</span> - i]</span><br><span class="line">        input_list[length - <span class="number">1</span> - i] = temp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(input_list)</span><br><span class="line"></span><br><span class="line">input_str = leak</span><br><span class="line">result = swap_bits(input_str)</span><br><span class="line">a=result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_add</span>(<span class="params">input_str</span>):</span><br><span class="line">    input_list = <span class="built_in">list</span>(input_str)</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        input_list[i] = <span class="built_in">str</span>((<span class="built_in">int</span>(input_list[i]) + i + <span class="number">1</span>) % <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span>.join(input_list)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">input_str = a</span><br><span class="line">result = custom_add(input_str)</span><br><span class="line">b=result</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="comment">#12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891134567789013445789912234667900123557889112356678911245568891223457790013345689901245667890234457799023355788001334678891124566790113445778902335578800133556899112346778011245567991223557880012355788902234677900124557889023355788001245568991133566790013445688912234577900124457889112456679001245578801233467789112355779912234577990233556780113</span></span><br></pre></td></tr></table></figure><p>根据上面的加密方式倒推出解密的函数即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_sub</span>(<span class="params">input_str</span>):</span><br><span class="line">    input_list = <span class="built_in">list</span>(input_str)</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        input_list[i] = <span class="built_in">str</span>((<span class="built_in">int</span>(input_list[i]) + <span class="number">10</span> - i - <span class="number">1</span>) % <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span>.join(input_list)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_swap_bits</span>(<span class="params">input_str</span>):</span><br><span class="line">    input_list = <span class="built_in">list</span>(input_str)</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">2</span>):</span><br><span class="line">        temp = input_list[i]</span><br><span class="line">        input_list[i] = input_list[length - <span class="number">1</span> - i]</span><br><span class="line">        input_list[length - <span class="number">1</span> - i] = temp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(input_list)</span><br><span class="line"></span><br><span class="line">encrypted_flag = <span class="string">&quot;12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891134567789013445789912234667900123557889112356678911245568891223457790013345689901245667890234457799023355788001334678891124566790113445778902335578800133556899112346778011245567991223557880012355788902234677900124557889023355788001245568991133566790013445688912234577900124457889112456679001245578801233467789112355779912234577990233556780113&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一步：解除自定义加法</span></span><br><span class="line">step1 = custom_sub(encrypted_flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二步：逆向位交换</span></span><br><span class="line">step2 = reverse_swap_bits(step1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(step2)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(step2,<span class="number">2</span>))</span><br><span class="line">x=<span class="string">&quot;1011000010110010100001101010100010001100111101101100011001110010011001000110100001100100011001100110101011001100010110101100011011000110110001000110100001011010011010001100110011000010110010100101101011000010011011100111001001110010010110101100101001110000011100001100001001101000011001001100100001100010011010000110010001101110011000001111101&quot;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(x,<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#10110000101100101000011010101000100011001111011011000110011100100110010001101000011001000110011001101010110011000101101011000110110001101100010001101000010110100110100011001100110000101100101001011010110000100110111001110010011100100101101011001010011100000111000011000010011010000110010011001000011000100110100001100100011011100110000011111010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"><span class="comment"># 9254392036983367729993565657642756163106647020423020921597044715242734027281359079743634890921671710476305652413203664281624325410548175719951158501965824</span></span><br><span class="line"><span class="comment"># b&#x27;XYCTF&#123;c924235f-ccb4-4fae-a799-e88a42d14270&#125;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CRYPTO </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>pyecharts绘制中国地图</title>
      <link href="/2024/04/10/pyecharts-hui-zhi-zhong-guo-di-tu/"/>
      <url>/2024/04/10/pyecharts-hui-zhi-zhong-guo-di-tu/</url>
      
        <content type="html"><![CDATA[<h2 id="pyecharts库"><a href="#pyecharts库" class="headerlink" title="pyecharts库"></a>pyecharts库</h2><p>通过测试发现，安装0.1.9.4版本最为稳定</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyecharts==<span class="number">0.1</span><span class="number">.9</span><span class="number">.4</span></span><br></pre></td></tr></table></figure><p>安装完成后，下面是一个简单的测试案例</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> Map</span><br><span class="line"></span><br><span class="line">province_distribution  = &#123;</span><br><span class="line">    <span class="string">&quot;北京&quot;</span>: <span class="number">3.923916945</span>,</span><br><span class="line">    <span class="string">&quot;天津&quot;</span>: <span class="number">1.974557674</span>,</span><br><span class="line">    <span class="string">&quot;河北&quot;</span>: <span class="number">0.031448024</span>,</span><br><span class="line">    <span class="string">&quot;山西&quot;</span>: -<span class="number">0.243928321</span>,</span><br><span class="line">    <span class="string">&quot;内蒙古&quot;</span>: <span class="number">0.285642805</span>,</span><br><span class="line">    <span class="string">&quot;辽宁&quot;</span>: -<span class="number">0.012222464</span>,</span><br><span class="line">    <span class="string">&quot;吉林&quot;</span>: <span class="number">0.037753234</span>,</span><br><span class="line">    <span class="string">&quot;黑龙江&quot;</span>: -<span class="number">0.098705912</span>,</span><br><span class="line">    <span class="string">&quot;上海&quot;</span>: <span class="number">2.498539306</span>,</span><br><span class="line">    <span class="string">&quot;江苏&quot;</span>: <span class="number">0.367988799</span>,</span><br><span class="line">    <span class="string">&quot;浙江&quot;</span>: <span class="number">0.889074231</span>,</span><br><span class="line">    <span class="string">&quot;安徽&quot;</span>: -<span class="number">0.6519182</span>,</span><br><span class="line">    <span class="string">&quot;福建&quot;</span>: -<span class="number">0.202640638</span>,</span><br><span class="line">    <span class="string">&quot;江西&quot;</span>: -<span class="number">0.968214234</span>,</span><br><span class="line">    <span class="string">&quot;山东&quot;</span>: <span class="number">0.355384584</span>,</span><br><span class="line">    <span class="string">&quot;河南&quot;</span>: -<span class="number">0.99580695</span>,</span><br><span class="line">    <span class="string">&quot;湖北&quot;</span>: -<span class="number">0.264681358</span>,</span><br><span class="line">    <span class="string">&quot;湖南&quot;</span>: -<span class="number">1.012688352</span>,</span><br><span class="line">    <span class="string">&quot;广东&quot;</span>: <span class="number">0.574760013</span>,</span><br><span class="line">    <span class="string">&quot;广西&quot;</span>: -<span class="number">0.830955316</span>,</span><br><span class="line">    <span class="string">&quot;海南&quot;</span>: <span class="number">0.149846753</span>,</span><br><span class="line">    <span class="string">&quot;重庆&quot;</span>: -<span class="number">0.431589086</span>,</span><br><span class="line">    <span class="string">&quot;四川&quot;</span>: -<span class="number">0.717277576</span>,</span><br><span class="line">    <span class="string">&quot;贵州&quot;</span>: -<span class="number">1.400394406</span>,</span><br><span class="line">    <span class="string">&quot;云南&quot;</span>: -<span class="number">1.016323672</span>,</span><br><span class="line">    <span class="string">&quot;西藏&quot;</span>: -<span class="number">0.146483877</span>,</span><br><span class="line">    <span class="string">&quot;陕西&quot;</span>: -<span class="number">0.202472393</span>,</span><br><span class="line">    <span class="string">&quot;甘肃&quot;</span>: -<span class="number">0.976863652</span>,</span><br><span class="line">    <span class="string">&quot;青海&quot;</span>: -<span class="number">0.352463859</span>,</span><br><span class="line">    <span class="string">&quot;宁夏&quot;</span>: -<span class="number">0.001899423</span>,</span><br><span class="line">    <span class="string">&quot;新疆&quot;</span>: -<span class="number">0.561382676</span></span><br><span class="line">&#125;</span><br><span class="line">provice = <span class="built_in">list</span>(province_distribution.keys())</span><br><span class="line">num = <span class="built_in">list</span>(province_distribution.values())</span><br><span class="line"></span><br><span class="line">chinaMap = Map(width=<span class="number">1200</span>, height=<span class="number">600</span>)</span><br><span class="line">chinaMap.add(name=<span class="string">&quot;医疗水平综合得分&quot;</span>,</span><br><span class="line">             attr=provice,</span><br><span class="line">             value=num,</span><br><span class="line">             visual_range=[-<span class="number">1.1</span>, <span class="number">1.5</span>],</span><br><span class="line">             maptype=<span class="string">&#x27;china&#x27;</span>,</span><br><span class="line">             is_visualmap=<span class="literal">True</span>)</span><br><span class="line">chinaMap.render(path=<span class="string">&quot;中国地图.html&quot;</span>)</span><br></pre></td></tr></table></figure><p>运行，会在同一目录下得到一个’中国地图.html’的文件，通过浏览器打开，可以得到如下的交互式地图</p><p><img src="https://pic.imgdb.cn/item/6616ab5468eb9357130f74dd.png" alt="alt text"></p><p>但是发现得到的地图无法自动显示各个省份的名称，因此可以使用<code>notepad++</code>打开’中国地图.html’，在一千九百多行的位置找到</p><p><img src="https://pic.imgdb.cn/item/6616ac1f68eb935713101e1f.png" alt="alt text"></p><p>添加如下内容并保存</p><p><img src="https://pic.imgdb.cn/item/6616ad3f68eb935713117bef.png" alt="alt text"></p><p>最终就可以得到带有省份名称的中国地图，可以下载保存</p><p><img src="https://pic.imgdb.cn/item/66169f6568eb935713011b92.png" alt="alt text"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>标准化、归一化、去中心化辨析</title>
      <link href="/2024/04/08/biao-zhun-hua-gui-yi-hua-qu-zhong-xin-hua-bian-xi/"/>
      <url>/2024/04/08/biao-zhun-hua-gui-yi-hua-qu-zhong-xin-hua-bian-xi/</url>
      
        <content type="html"><![CDATA[<p>标准化（Standardization）、归一化（Normalization）和去中心化（Centering）是数据预处理中常用的三种不同的缩放技术，它们都旨在调整数据的尺度，以便于进行后续的分析和机器学习任务。虽然这些术语有时被交替使用，但它们在数学上有着不同的含义和应用场景。</p><h3 id="标准化（Standardization）"><a href="#标准化（Standardization）" class="headerlink" title="标准化（Standardization）"></a>标准化（Standardization）</h3><p>标准化是将数据转换为具有特定均值和标准差的过程。通常，标准化会使得数据的均值变为0，标准差变为1。这是通过以下公式完成的（Z-score规范化）：</p><p>$$ z &#x3D; \frac{(x - \mu)}{\sigma} $$</p><p>其中，$\ x $ 是原始数据点，$ \mu $ 是数据集的均值，$ \sigma $ 是数据集的标准差，$ z $ 是标准化后的值。</p><p>标准化的主要目的是消除不同量纲和尺度的影响，使得数据在进行计算和比较时更加公平。它在许多机器学习算法中非常有用，尤其是那些基于距离的算法，如K-近邻（KNN）和主成分分析（PCA）。</p><h3 id="归一化（Normalization）"><a href="#归一化（Normalization）" class="headerlink" title="归一化（Normalization）"></a>归一化（Normalization）</h3><p>归一化通常指的是将数据缩放到一个固定的范围，最常见的是[0, 1]。归一化的公式如下：</p><p>$$ x_{\text{norm}} &#x3D; \frac{x - \text{min}(x)}{\text{max}(x) - \text{min}(x)} $$</p><p>其中，$\ x $ 是原始数据点，<code>min(x)</code>和<code>max(x)</code>分别是数据集中的最小值和最大值，$ x_{\text{norm}} $ 是归一化后的值。</p><p>归一化对于需要数据在固定范围内进行计算的算法非常有用，如梯度下降和神经网络。它也常用于数据可视化，使得不同的数据点可以在同一尺度下比较。</p><h3 id="去中心化（Centering）"><a href="#去中心化（Centering）" class="headerlink" title="去中心化（Centering）"></a>去中心化（Centering）</h3><p>中心化是将数据的均值变为0的过程，但不改变数据的标准差。这可以通过以下公式完成：</p><p>$$ x_{\text{centered}} &#x3D; x - \mu $$</p><p>其中，$\ x$ 是原始数据点 ，$ \mu$ 是数据集的均值，$ x_{\text{centered}} $ 是去中心化后的值。</p><p>去中心化有助于突出数据中的异常值和波动，因为它保留了原始数据的方差。它在某些统计分析和时间序列分析中非常有用，尤其是在计算偏差或平均偏差时。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li><strong>标准化</strong>：调整数据的均值和标准差，使其具有均值为0和标准差为1的特性。</li><li><strong>归一化</strong>：将数据缩放到一个固定范围，通常是[0, 1]。</li><li><strong>去中心化</strong>：仅将数据的均值调整为0，不改变其标准差。</li></ul><p>在实际应用中，选择哪种方法取决于数据的特性和后续分析的需求。有时，这些方法可以组合使用，以达到最佳的预处理效果。例如，可以先进行去中心化，然后进行标准化或归一化。</p><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a href="http://t.csdnimg.cn/uvG6k">http://t.csdnimg.cn/uvG6k</a></p><p><a href="http://t.csdnimg.cn/80z2S">http://t.csdnimg.cn/80z2S</a></p>]]></content>
      
      
      <categories>
          
          <category> 数模 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>数据标准化处理疑问</title>
      <link href="/2024/04/08/shu-ju-biao-zhun-hua-chu-li-yi-wen/"/>
      <url>/2024/04/08/shu-ju-biao-zhun-hua-chu-li-yi-wen/</url>
      
        <content type="html"><![CDATA[<h2 id="标准化常使用的工具"><a href="#标准化常使用的工具" class="headerlink" title="标准化常使用的工具"></a>标准化常使用的工具</h2><p>1.使用 <code>sklearn</code> 库中的 <code>StandardScaler</code></p><p><code>StandardScaler</code> 是 <code>scikit-learn</code> 库中用于数据预处理的一个工具，它对每个特征进行标准化，使得特征的均值为0，标准差为1。这样做可以确保每个特征在PCA或其他算法中具有相同的重要性，因为算法通常对特征的尺度敏感。</p><p><code>StandardScaler</code> 使用的公式如下：</p><p>对于每个特征中的每个数据点 <code>x</code>，标准化后的值 <code>x_std</code> 计算方法为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x_std = (x - mean) / std</span><br></pre></td></tr></table></figure><p>其中，<code>mean</code> 是该特征所有数据点的均值，<code>std</code> 是该特征所有数据点的标准差。</p><p><code>StandardScaler</code> 首先计算整个数据集的均值和标准差，然后使用这些参数对每个特征的每个数据点进行标准化。这个过程通过 <code>fit</code> 方法完成，然后 <code>transform</code> 方法应用于原始数据，以生成标准化后的数据。</p><p>在实际应用中，<code>fit_transform</code> 方法通常一起使用，因为它首先计算均值和标准差（fit），然后使用这些参数来转换数据（transform）。这样可以确保数据的标准化是基于整个数据集的，而不是基于数据集的一部分。</p><p>转化后的数值，均值为0，标准差为1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取数据</span></span><br><span class="line">MVdata=pd.read_excel(<span class="string">r&quot;C:\Users\Jr.hu\Desktop\指标正向化后.xlsx&quot;</span>,index_col=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据标准化</span></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">MVdata_scaled = scaler.fit_transform(MVdata)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;数据标准化后：\n&quot;</span>,MVdata_scaled)</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66134e4e68eb93571348157b.png" alt="alt text"></p><p>2.自己定义公式进行计算</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">S=(MVdata-MVdata.mean())/MVdata.std()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;标准化处理后的数据:\n&quot;</span>, <span class="built_in">round</span>(S,<span class="number">4</span>))</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/66134f9d68eb9357134b57ff.png" alt="alt text"></p><p>这里发现会有一点的误差，很奇怪，看公式应该是一样的，不知道为什么</p><p>对比之后我个人认为还是第二种方法计算出来的结果相对准确一点</p><p>后面有时间再详细测试一下为什么吧</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.cnblogs.com/chentiao/p/17203643.html">https://www.cnblogs.com/chentiao/p/17203643.html</a></p><p><a href="http://t.csdnimg.cn/wUqmh">http://t.csdnimg.cn/wUqmh</a></p><p>上面两篇还未认真学习，先放一下</p><h2 id="一起进步！"><a href="#一起进步！" class="headerlink" title="一起进步！"></a>一起进步！</h2>]]></content>
      
      
      <categories>
          
          <category> 数模 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>主成分分析</title>
      <link href="/2024/04/08/zhu-cheng-fen-fen-xi/"/>
      <url>/2024/04/08/zhu-cheng-fen-fen-xi/</url>
      
        <content type="html"><![CDATA[<h2 id="主成分能用来做什么"><a href="#主成分能用来做什么" class="headerlink" title="主成分能用来做什么"></a>主成分能用来做什么</h2><p>聚类、回归、寻找变量之间的共线性关系！！！</p><p>主成分分析的一般目的由两点组成：（参考王学民老师）</p><p>（1）将多个有相关关系的变量压缩成少数几个不相关的主成分（综合变量），并保留绝大部分信息；</p><p>（2）给出各主成分的具有实际背景和意义的解释</p><h2 id="雷点在于！！！"><a href="#雷点在于！！！" class="headerlink" title="雷点在于！！！"></a>雷点在于！！！</h2><p><img src="https://pic.imgdb.cn/item/6612cf7b68eb935713aeefb1.png" alt="alt text"><br><img src="https://pic.imgdb.cn/item/6612d01468eb935713b00017.png" alt="alt text"> </p><p>多数论文以及博客使用主成分进行综合评价，王学民老师认为这是不对的，个人参考了一些这方面的研究后觉得王老师说的对。。。</p><p><img src="https://pic.imgdb.cn/item/6612d0cc68eb935713b139ed.png" alt="alt text"><br><img src="https://pic.imgdb.cn/item/6612d20768eb935713b347d3.png" alt="alt text"><br><img src="https://pic.imgdb.cn/item/6612d20068eb935713b345a0.png" alt="alt text"><br><img src="https://pic.imgdb.cn/item/6612d20768eb935713b347eb.png" alt="alt text"><br><img src="https://pic.imgdb.cn/item/6612d20768eb935713b347ff.png" alt="alt text"><br><img src="https://pic.imgdb.cn/item/6612d20668eb935713b347c3.png" alt="alt text"></p><p>因为个人理解能力有限，一知半解，只好放老师的文章来观摩学习</p><p>下面是复现一篇论文时写的python代码，除了最后评价分析这里不科学，其他的地方还行吧，权当存档留念，以后再也不傻乎乎的用主成分进行综合评价了。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> scale</span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line"><span class="keyword">from</span> factor_analyzer.factor_analyzer <span class="keyword">import</span> calculate_bartlett_sphericity</span><br><span class="line"><span class="keyword">from</span> factor_analyzer.factor_analyzer <span class="keyword">import</span> calculate_kmo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置中文字符及负号</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;Kaiti&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>]=<span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取文件</span></span><br><span class="line">MVdata=pd.read_excel(<span class="string">r&quot;C:\Users\Jr.hu\Desktop\指标正向化后.xlsx&quot;</span>,index_col=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 展示数据</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;原始数据展示:\n&quot;</span>, MVdata)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 首先对数据进行检验分析</span></span><br><span class="line"><span class="comment"># 1.Bartlett&#x27;s球状检验</span></span><br><span class="line">chi_square_value, p_value = calculate_bartlett_sphericity(MVdata)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;bartlett球状检验参数：\n卡方值为：&#123;&#125;，p值为：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(chi_square_value, p_value))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.KMO检验</span></span><br><span class="line">kmo_all, kmo_model = calculate_kmo(MVdata)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;KMO检验参数：\n&quot;</span>, kmo_model)</span><br><span class="line"><span class="comment"># 参数检验通过</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里需要先进行一些分析，为主成分分析做铺垫</span></span><br><span class="line"><span class="comment"># 对原始数据进行标准差标准化  这里采用课件中的方法</span></span><br><span class="line">S=(MVdata-MVdata.mean())/MVdata.std()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;标准化处理后的数据:\n&quot;</span>, <span class="built_in">round</span>(S,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求相关系数矩阵</span></span><br><span class="line">CovX=np.around(np.corrcoef(MVdata.T),decimals=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;相关系数矩阵为：\n&quot;</span>,CovX)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解特征值和特征向量</span></span><br><span class="line">featValue,featVec=np.linalg.eig(CovX.T)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;特征值为：\n&quot;</span>,featValue)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;特征向量为：\n&quot;</span>,featVec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对特征值进行排序输出</span></span><br><span class="line">featValue=<span class="built_in">sorted</span>(featValue,reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;特征值从高到低依次为：\n&quot;</span>,featValue)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制特征值碎石图</span></span><br><span class="line">plt.scatter(<span class="built_in">range</span>(<span class="number">1</span>,MVdata.shape[<span class="number">1</span>]+<span class="number">1</span>),featValue)</span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>,MVdata.shape[<span class="number">1</span>]+<span class="number">1</span>),featValue)</span><br><span class="line">plt.hlines(y=<span class="number">1</span>,xmin=<span class="number">0</span>,xmax=<span class="number">14</span>,colors=<span class="string">&#x27;red&#x27;</span>,linestyles=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;Scree Plot&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Factors&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Eigenvalue&quot;</span>)</span><br><span class="line">plt.grid()  <span class="comment"># 显示网格</span></span><br><span class="line">plt.show()  <span class="comment"># 显示图形</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制累计贡献度折线图</span></span><br><span class="line">gx=featValue/np.<span class="built_in">sum</span>(featValue)   <span class="comment"># 贡献度</span></span><br><span class="line">lg=np.cumsum(gx)    <span class="comment"># 累计贡献度</span></span><br><span class="line">plt.scatter(<span class="built_in">range</span>(<span class="number">1</span>,MVdata.shape[<span class="number">1</span>]+<span class="number">1</span>),lg)</span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>,MVdata.shape[<span class="number">1</span>]+<span class="number">1</span>),lg)</span><br><span class="line">plt.hlines(y=<span class="number">0.85</span>,xmin=<span class="number">0</span>,xmax=<span class="number">14</span>,colors=<span class="string">&#x27;red&#x27;</span>,linestyles=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">plt.text(<span class="number">1</span>,<span class="number">0.86</span>,<span class="string">&quot;85%水平线&quot;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;累计贡献度&quot;</span>)</span><br><span class="line">plt.grid()  <span class="comment"># 显示网格</span></span><br><span class="line">plt.show()  <span class="comment"># 显示图形</span></span><br><span class="line"><span class="comment"># 由碎石图及折线图综合分析可知，主成分分析应分为四类，k=4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一步，计算主成分对象</span></span><br><span class="line">pcal =PCA(n_components=<span class="number">4</span>).fit(S)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二步，确定主成分</span></span><br><span class="line">V=pcal.explained_variance_   <span class="comment"># 各个主成分所解释的数据方差</span></span><br><span class="line">W=pcal.explained_variance_ratio_  <span class="comment"># 各个主成分的方差解释比例</span></span><br><span class="line">W.<span class="built_in">sum</span>()    <span class="comment"># 所有主成分解释的总方差</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;各个主成分所解释的数据方差为:\n&quot;</span>, V)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;各个主成分的方差贡献率为:\n&quot;</span>, W)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;累计方差贡献率为:\n&quot;</span>, W.<span class="built_in">sum</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第三步，主成分负荷</span></span><br><span class="line">Comp_P=pd.DataFrame(pcal.components_.T)   <span class="comment"># 主成分载荷矩阵</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;主成分载荷矩阵为:\n&quot;</span>, Comp_P)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里可以绘制一张热力图表示原先的13个因子与降维后的4个主成分之间的关系</span></span><br><span class="line">ax = sns.heatmap(Comp_P, annot=<span class="literal">True</span>, cmap=<span class="string">&quot;coolwarm&quot;</span>)</span><br><span class="line">ax.set_xticks([<span class="number">0.5</span>, <span class="number">1.5</span>, <span class="number">2.5</span>, <span class="number">3.5</span>])</span><br><span class="line">ax.set_xticklabels([<span class="string">&#x27;Comp1&#x27;</span>, <span class="string">&#x27;Comp2&#x27;</span>, <span class="string">&#x27;Comp3&#x27;</span>, <span class="string">&#x27;Comp4&#x27;</span>])  <span class="comment"># 设置x轴的标签</span></span><br><span class="line">ax.set_yticks([<span class="number">0.5</span>,<span class="number">1.5</span>,<span class="number">2.5</span>,<span class="number">3.5</span>,<span class="number">4.5</span>,<span class="number">5.5</span>,<span class="number">6.5</span>,<span class="number">7.5</span>,<span class="number">8.5</span>,<span class="number">9.5</span>,<span class="number">10.5</span>,<span class="number">11.5</span>,<span class="number">12.5</span>])</span><br><span class="line">ax.set_yticklabels([<span class="string">&#x27;x1&#x27;</span>,<span class="string">&#x27;x2&#x27;</span>,<span class="string">&#x27;x3&#x27;</span>,<span class="string">&#x27;x4&#x27;</span>,<span class="string">&#x27;x5&#x27;</span>,<span class="string">&#x27;x6&#x27;</span>,<span class="string">&#x27;x7&#x27;</span>,<span class="string">&#x27;x8&#x27;</span>,<span class="string">&#x27;x9&#x27;</span>,<span class="string">&#x27;x10&#x27;</span>,<span class="string">&#x27;x11&#x27;</span>,<span class="string">&#x27;x12&#x27;</span>,<span class="string">&#x27;x13&#x27;</span>])  <span class="comment"># 设置y轴的标签</span></span><br><span class="line">plt.title(<span class="string">&quot;Factor Analysis&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第四步，先算各个主成分得分</span></span><br><span class="line">Si=pcal.fit_transform(S)</span><br><span class="line">SR=pd.DataFrame(Si,columns=[<span class="string">&#x27;Comp1&#x27;</span>,<span class="string">&#x27;Comp2&#x27;</span>,<span class="string">&#x27;Comp3&#x27;</span>,<span class="string">&#x27;Comp4&#x27;</span>],index=MVdata.index)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;主成分得分:\n&quot;</span>, SR)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第五步，再算综合评价得分</span></span><br><span class="line">SR[<span class="string">&#x27;Comp&#x27;</span>]=Si.dot(W)</span><br><span class="line">SR[<span class="string">&#x27;Rank&#x27;</span>]=SR.Comp.rank(ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;主成分综合评价得分:\n&quot;</span>, SR)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据可视化一：箱线图</span></span><br><span class="line"><span class="comment"># 箱线图1.0(最终得分的箱线图)</span></span><br><span class="line">sns.boxplot(y=SR[<span class="string">&#x27;Comp&#x27;</span>])   <span class="comment"># y轴为各地最终的评价得分</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;综合评价最终得分&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;最终得分箱线图&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 箱线图2.0(四个主成分得分的箱线图)</span></span><br><span class="line">fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">10</span>, <span class="number">8</span>))   <span class="comment"># 创建包含四个子图的画布</span></span><br><span class="line">sns.boxplot(y=SR[<span class="string">&#x27;Comp1&#x27;</span>], ax=axes[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">sns.boxplot(y=SR[<span class="string">&#x27;Comp2&#x27;</span>], ax=axes[<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">sns.boxplot(y=SR[<span class="string">&#x27;Comp3&#x27;</span>], ax=axes[<span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">sns.boxplot(y=SR[<span class="string">&#x27;Comp4&#x27;</span>], ax=axes[<span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据可视化二：小提琴图</span></span><br><span class="line"><span class="comment"># 小提琴图1.0(最终得分小提琴图)</span></span><br><span class="line">sns.violinplot(x=<span class="string">&#x27;Comp&#x27;</span>,data=SR)</span><br><span class="line">plt.title(<span class="string">&#x27;最终得分小提琴图&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;综合评价最终得分&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 小提琴图2.0(四个主成分得分的小提琴图)</span></span><br><span class="line">fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">10</span>, <span class="number">8</span>))   <span class="comment"># 创建包含四个子图的画布</span></span><br><span class="line">sns.violinplot(y=SR[<span class="string">&#x27;Comp1&#x27;</span>], ax=axes[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">sns.violinplot(y=SR[<span class="string">&#x27;Comp2&#x27;</span>], ax=axes[<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">sns.violinplot(y=SR[<span class="string">&#x27;Comp3&#x27;</span>], ax=axes[<span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">sns.violinplot(y=SR[<span class="string">&#x27;Comp4&#x27;</span>], ax=axes[<span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化三：条图</span></span><br><span class="line"><span class="comment"># 这个没想到合适的数据，先放一放</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化四：概率分布图</span></span><br><span class="line"><span class="comment"># 概率分布图1.0---数据标准化处理之后的概率分布图</span></span><br><span class="line">sns.histplot(S,kde=<span class="literal">True</span>,color=<span class="string">&#x27;blue&#x27;</span>,bins=<span class="number">30</span>)   <span class="comment"># 这里可以单独看S[&quot;x1&quot;]...</span></span><br><span class="line">plt.title(<span class="string">&#x27;数据标准化处理后的概率分布图&#x27;</span>)  <span class="comment"># 标准化处理后满足正态分布</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;概率密度&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;数值&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 概率分布图2.0---这里我们选取了最终评价得分Comp为y轴,主成分一得分Comp1为x轴,可以呈现出较好的效果</span></span><br><span class="line">sns.jointplot(x=SR[<span class="string">&#x27;Comp1&#x27;</span>],y=SR[<span class="string">&#x27;Comp&#x27;</span>],data=SR)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 概率分布图3.0---多个变量,四个主成分的得分</span></span><br><span class="line">sns.pairplot(SR, <span class="built_in">vars</span>=[<span class="string">&#x27;Comp1&#x27;</span>,<span class="string">&#x27;Comp2&#x27;</span>,<span class="string">&#x27;Comp3&#x27;</span>,<span class="string">&#x27;Comp4&#x27;</span>])</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化五：柱状图</span></span><br><span class="line"><span class="comment"># 柱状图1.0---各个主成分的方差贡献率</span></span><br><span class="line">x = [<span class="string">&#x27;Comp1&#x27;</span>,<span class="string">&#x27;Comp2&#x27;</span>,<span class="string">&#x27;Comp3&#x27;</span>,<span class="string">&#x27;Comp4&#x27;</span>]</span><br><span class="line">y = [<span class="string">&#x27;Comp1&#x27;</span>,<span class="string">&#x27;Comp1、2&#x27;</span>,<span class="string">&#x27;Comp1、2、3&#x27;</span>,<span class="string">&#x27;Comp1、2、3、4&#x27;</span>]</span><br><span class="line">plt.grid(ls=<span class="string">&quot;--&quot;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.title(<span class="string">&quot;各个主成分的方差贡献率&quot;</span>)</span><br><span class="line">bars = plt.bar(x, W)</span><br><span class="line"><span class="keyword">for</span> i, bar <span class="keyword">in</span> <span class="built_in">enumerate</span>(bars):   <span class="comment"># 添加百分比标签</span></span><br><span class="line">    plt.text(bar.get_x() + bar.get_width() / <span class="number">2</span>, bar.get_height(), <span class="string">f&quot;<span class="subst">&#123;W[i]*<span class="number">100</span>:<span class="number">.2</span>f&#125;</span>%&quot;</span>,</span><br><span class="line">             ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 柱状图2.0---累计方差贡献率柱状图</span></span><br><span class="line">cumulative_variance = [<span class="built_in">sum</span>(W[:i+<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(W))]    <span class="comment"># 计算累计方差贡献率</span></span><br><span class="line">plt.figure()</span><br><span class="line">plt.grid(ls=<span class="string">&quot;--&quot;</span>,alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.title(<span class="string">&quot;累计方差贡献率&quot;</span>)</span><br><span class="line">bars = plt.bar(y, cumulative_variance)</span><br><span class="line"><span class="keyword">for</span> i, bar <span class="keyword">in</span> <span class="built_in">enumerate</span>(bars):      <span class="comment"># 添加百分比标签</span></span><br><span class="line">    plt.text(bar.get_x() + bar.get_width() / <span class="number">2</span>, bar.get_height(), <span class="string">f&quot;<span class="subst">&#123;cumulative_variance[i]*<span class="number">100</span>:<span class="number">.2</span>f&#125;</span>%&quot;</span>,</span><br><span class="line">             ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 柱状图3.0---综合评级得分柱状图</span></span><br><span class="line">plt.figure()</span><br><span class="line">plt.grid(ls=<span class="string">&quot;--&quot;</span>,alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.title(<span class="string">&quot;各省份综合评价得分条形图&quot;</span>)</span><br><span class="line">bars = plt.bar(SR[<span class="string">&#x27;Rank&#x27;</span>], SR[<span class="string">&#x27;Comp&#x27;</span>])</span><br><span class="line">text= [</span><br><span class="line">    <span class="string">&quot;北京市&quot;</span>, <span class="string">&quot;天津市&quot;</span>, <span class="string">&quot;河北省&quot;</span>, <span class="string">&quot;山西省&quot;</span>, <span class="string">&quot;内蒙古自治区&quot;</span>,</span><br><span class="line">    <span class="string">&quot;辽宁省&quot;</span>, <span class="string">&quot;吉林省&quot;</span>, <span class="string">&quot;黑龙江省&quot;</span>, <span class="string">&quot;上海市&quot;</span>, <span class="string">&quot;江苏省&quot;</span>,</span><br><span class="line">    <span class="string">&quot;浙江省&quot;</span>, <span class="string">&quot;安徽省&quot;</span>, <span class="string">&quot;福建省&quot;</span>, <span class="string">&quot;江西省&quot;</span>, <span class="string">&quot;山东省&quot;</span>,</span><br><span class="line">    <span class="string">&quot;河南省&quot;</span>, <span class="string">&quot;湖北省&quot;</span>, <span class="string">&quot;湖南省&quot;</span>, <span class="string">&quot;广东省&quot;</span>, <span class="string">&quot;广西壮族自治区&quot;</span>,</span><br><span class="line">    <span class="string">&quot;海南省&quot;</span>, <span class="string">&quot;重庆市&quot;</span>, <span class="string">&quot;四川省&quot;</span>, <span class="string">&quot;贵州省&quot;</span>, <span class="string">&quot;云南省&quot;</span>,</span><br><span class="line">    <span class="string">&quot;西藏自治区&quot;</span>, <span class="string">&quot;陕西省&quot;</span>, <span class="string">&quot;甘肃省&quot;</span>, <span class="string">&quot;青海省&quot;</span>, <span class="string">&quot;宁夏回族自治区&quot;</span>,</span><br><span class="line">    <span class="string">&quot;新疆维吾尔自治区&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> bar, province <span class="keyword">in</span> <span class="built_in">zip</span>(bars, text):</span><br><span class="line">    yval = bar.get_height()</span><br><span class="line">    plt.text(bar.get_x() + bar.get_width()/<span class="number">2</span>, yval, province, ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主成分图（取前两个主成分）</span></span><br><span class="line">plt.plot(SR.Comp1,SR.Comp2,<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">A1=SR.Comp1</span><br><span class="line">A2=SR.Comp2</span><br><span class="line">AI=SR.index</span><br><span class="line">plt.hlines(<span class="number">0</span>,A1.<span class="built_in">min</span>(),A1.<span class="built_in">max</span>(),linestyles=<span class="string">&quot;dotted&quot;</span>)</span><br><span class="line">plt.vlines(<span class="number">0</span>,A2.<span class="built_in">min</span>(),A2.<span class="built_in">max</span>(),linestyles=<span class="string">&quot;dotted&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(SR.index.shape[<span class="number">0</span>]):</span><br><span class="line">    plt.text(A1[i],A2[i],AI[i])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><h2 id="关于相关系数矩阵与协方差矩阵"><a href="#关于相关系数矩阵与协方差矩阵" class="headerlink" title="关于相关系数矩阵与协方差矩阵"></a>关于相关系数矩阵与协方差矩阵</h2><p>主成分分析（PCA）既可以使用协方差矩阵，也可以使用相关系数矩阵，具体选择哪种取决于数据的特性和分析的目的。以下是对两种矩阵在PCA中使用的考量因素：</p><p><strong>协方差矩阵</strong>：</p><ul><li><strong>适用情况</strong>：当原始数据的各个变量具有不同的量纲（如长度、重量、时间等）或者变量的尺度差异较大时，使用协方差矩阵更为合适。协方差矩阵直接反映了变量间因数值大小变化引起的线性关系，保留了原始变量的量纲信息。</li><li><strong>优点</strong>：能够捕捉变量间原始的、未经标准化的波动关系，对于那些量纲差异显著且这种差异对分析有重要意义的情况，使用协方差矩阵能够保持这些差异对主成分的影响。</li></ul><p><strong>相关系数矩阵</strong>：</p><ul><li><strong>适用情况</strong>：当原始数据的各个变量在同一量纲下或者经过标准化处理（即所有变量均转化为无量纲的、均值为0、标准差为1的状态）时，使用相关系数矩阵更为合适。相关系数矩阵衡量的是变量间关系的方向和强度，不受变量尺度的影响。</li><li><strong>优点</strong>：<ul><li><strong>消除量纲影响</strong>：由于相关系数矩阵中的元素是标准化数据的协方差，它已经消除了变量各自尺度的影响，只反映变量间相对变化的一致性。这使得不同量纲或不同尺度的变量在PCA中得以公平比较，避免了量纲较大或波动范围较大的变量对分析结果的主导。</li><li><strong>易于解释</strong>：相关系数的取值范围在-1到1之间，可以直接解读为变量间的线性相关程度，更便于理解和解释变量间的关系。</li></ul></li></ul><p><strong>选择原则</strong>：</p><ul><li>如果数据集中的变量具有相同的量纲或已经过标准化处理，通常建议使用相关系数矩阵，因为它能够更纯粹地反映变量间的相对关系，不受变量自身尺度的干扰。</li><li>如果变量间存在显著的量纲差异，并且这些差异对分析结果有重要含义</li></ul><h2 id="sklearn库默认使用协方差矩阵"><a href="#sklearn库默认使用协方差矩阵" class="headerlink" title="sklearn库默认使用协方差矩阵"></a>sklearn库默认使用协方差矩阵</h2><p><code>sklearn</code> 库在执行主成分分析（PCA）时，默认使用的是协方差矩阵。这是因为 <code>sklearn.decomposition.PCA</code> 类在计算主成分时，默认计算的是数据的协方差矩阵。然而，用户可以根据实际需求选择是否对输入数据进行预处理（如标准化），从而转换为使用相关系数矩阵进行PCA。</p><p>以下是使用 <code>sklearn</code> 进行PCA时与矩阵选择相关的几点说明：</p><ol><li><p><strong>默认行为</strong>：如果不进行额外的预处理，直接将原始数据传递给 <code>sklearn.decomposition.PCA</code> 类的实例，并进行拟合（fit），那么PCA将基于数据的协方差矩阵来确定主成分。</p></li><li><p><strong>标准化选项</strong>：如果希望使用相关系数矩阵进行PCA，通常需要先对数据进行标准化，即将数据转换为无量纲的、均值为0、标准差为1的形式。在 <code>sklearn</code> 中，可以使用 <code>preprocessing</code> 模块中的 <code>StandardScaler</code> 类来完成这一操作。对数据标准化后再进行PCA，此时虽然PCA内部依然计算的是标准化后数据的协方差矩阵，但由于标准化数据的均值和方差已调整为一致，此时的协方差矩阵实际上等价于相关系数矩阵，因为标准化消除了量纲和尺度的影响。</p></li></ol><p>例如，一个完整的流程可能如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设 data 是未标准化的原始数据</span></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">scaled_data = scaler.fit_transform(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并拟合PCA模型，此时使用的是等价于相关系数矩阵的标准化数据的协方差矩阵</span></span><br><span class="line">pca = PCA()</span><br><span class="line">pca.fit(scaled_data)</span><br></pre></td></tr></table></figure><ol start="3"><li><strong>参数设置</strong>：<code>sklearn</code> 的 <code>PCA</code> 类提供了 <code>covariance</code> 参数（从 <code>scikit-learn</code> 1.1 及更高版本开始），允许用户直接指定是否基于数据的协方差矩阵还是基于相关系数矩阵来进行PCA计算。不过，需要注意的是，设置 <code>covariance=&#39;corr&#39;</code> 时，<code>sklearn</code> 会自动对数据进行标准化，然后计算相关系数矩阵。因此，对于用户来说，直接对数据进行标准化仍然是推荐的做法，而不需要显式设置 <code>covariance</code> 参数。</li></ol><p>总结起来，在使用 <code>sklearn</code> 库进行主成分分析时，默认是基于协方差矩阵。若要基于相关系数矩阵进行分析，通常做法是先对数据进行标准化处理，确保变量间的关系不受量纲和尺度差异的影响。尽管 <code>sklearn</code> 提供了参数来直接指定基于相关系数矩阵计算，但实践中更常见的是通过预处理步骤标准化数据，间接实现基于相关系数矩阵的PCA。</p><h2 id="错上加错（载荷矩阵）"><a href="#错上加错（载荷矩阵）" class="headerlink" title="错上加错（载荷矩阵）"></a>错上加错（载荷矩阵）</h2><p>关于<code>载荷矩阵</code>的一点思考与说明</p><p>在上面的处理过程中，使用到了载荷矩阵，但是按照同样的思路使用<code>spss</code>来分析，得到的主成分系数矩阵不一样，结果相差很大</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第三步，主成分负荷</span></span><br><span class="line">Comp_P=pd.DataFrame(pcal.components_.T)   <span class="comment"># 主成分载荷矩阵</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;主成分载荷矩阵为:\n&quot;</span>, Comp_P)</span><br></pre></td></tr></table></figure><p>上面的代码中关于<code>载荷矩阵</code>的计算是没有问题的，<code>载荷矩阵</code>描述了主变量与原始变量之间的相关系数，各个主成分的<code>得分系数矩阵</code>需要使用<code>载荷矩阵</code>除以对应<code>特征值的平方根</code>，这个系数才能表示各个变量与主变量之间的<code>线性关系</code></p><p>在上面的代码中，使用<code>sklrean</code>库进行分析直接用载荷矩阵描述各个变量与主变量之间的线性关系，缺少了一步转换</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主成分得分系数矩阵  </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>): </span><br><span class="line">    Comp_P[i]=Comp_P[i]/math.sqrt(V[i])    <span class="comment"># 计算公式为载荷矩阵除以对应主成分的特征值，这个操作是参考这篇文章：https://zhuanlan.zhihu.com/p/49481213</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;主成分得分矩阵:\n&quot;</span>, Comp_P)</span><br></pre></td></tr></table></figure><p>至于使用spss分析时，做主成分分析不要选择<code>旋转</code>,否则就变成了<code>因子分析</code>,结果当然不一样</p><p><img src="https://pic.imgdb.cn/item/6613ca9868eb9357132a62c2.png" alt="alt text"><br><img src="https://pic.imgdb.cn/item/6613ca9868eb9357132a6267.png" alt="alt text"></p><p>关于<code>因子分析</code>与<code>主成分分析</code>的区别和联系，下面放了一篇很好的文章</p><p>但是换句话说，反正都错了，错上加错也无所谓了。。。。</p><h2 id="参考借鉴"><a href="#参考借鉴" class="headerlink" title="参考借鉴"></a>参考借鉴</h2><p>做综合评价：</p><p><a href="http://t.csdnimg.cn/VvKCZ">http://t.csdnimg.cn/VvKCZ</a></p><p><a href="http://t.csdnimg.cn/ak1oY">http://t.csdnimg.cn/ak1oY</a></p><p><a href="http://t.csdnimg.cn/V8Cak">http://t.csdnimg.cn/V8Cak</a></p><p>做降维、聚类：</p><p><a href="https://www.cnblogs.com/RHadoop-Hive/p/9441505.html">https://www.cnblogs.com/RHadoop-Hive/p/9441505.html</a></p><p>做回归：</p><p>主成分分析 - Sophie的文章 - 知乎<br><a href="https://zhuanlan.zhihu.com/p/653310400">https://zhuanlan.zhihu.com/p/653310400</a></p><p>关于载荷矩阵的说明：</p><p>主成分分析PCA之Python与SPSS展示的区别 - canhui87的文章 - 知乎</p><p><a href="https://zhuanlan.zhihu.com/p/76622543">https://zhuanlan.zhihu.com/p/76622543</a></p><p>如何做主成分分析和因子分析？它们的区别与联系在哪里？ - 胡保强的文章 - 知乎</p><p><a href="https://zhuanlan.zhihu.com/p/49481213">https://zhuanlan.zhihu.com/p/49481213</a></p><h2 id="一起进步！"><a href="#一起进步！" class="headerlink" title="一起进步！"></a>一起进步！</h2>]]></content>
      
      
      <categories>
          
          <category> 数模 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>WP_2024NKCTF_CRYPTO_ezmath</title>
      <link href="/2024/03/26/wp-2024nkctf-crypto-ezmath/"/>
      <url>/2024/03/26/wp-2024nkctf-crypto-ezmath/</url>
      
        <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m1, m2 = bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]), bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:])</span><br><span class="line">p, q, r, s = [getStrongPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">n = p * q * r * s</span><br><span class="line">x = <span class="built_in">pow</span>(q + r, p, n)</span><br><span class="line">y = <span class="built_in">pow</span>(p * q + r, p, n)</span><br><span class="line">z = <span class="built_in">pow</span>(s + <span class="number">1</span>, m1, s ** <span class="number">3</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m2, e * (s - <span class="number">1</span>), n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;x = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;y = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;z = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 16063619267258988011034805988633616492558472337115259037200126862563048933118401979462064790962157697989038876156970157178132518189429914950166878537819575544418107719419007799951815657212334175336430766777427972314839713871744747439745897638084891777417411340564312381163685003204182743581513722530953822420925665928135283753941119399766754107671729392716849464530701015719632309411962242638805053491529098780122555818774774959577492378249768503656934696409965037843388835948033129997732058133842695370074265039977902884020467413323500218577769082193651281154702147769044514475692164145099161948955990463002411473013</span></span><br><span class="line"><span class="comment"># x = 3021730035236300354492366560252387204933590210661279960796549263827016146230329262559940840168033978439210301546282150367717272453598367244078695402717500358042032604007007155898199149948267938948641512214616076878271433754986480186150178487625316601499002827958344941689933374158456614113935145081427421623647242719093642478556263121508238995676370877385638074444859047640771188280945186355013165130171802867101829647797879344213688981448535289683363612035513789240264618036062440178755665951650666056478493289870170026121826588708849844053588998886259091357236645819074078054595561158630194224419831088510266212458</span></span><br><span class="line"><span class="comment"># y = 8995787142441643101775260550632842535051686960331455373408888374295557050896156890779515089927839904014859222004906681231525326673182671984194300730575609496770604394218160422560576866112460837985407931067753009696969997384839637927957848613356269534870170452152926447601781637641134982178028922559652443398183848786034348994249923007092159192374765197460466878587635412657807328348343062302127490267456095927890461140420639805398464266081441243108883599713672104446500850203779995739675784794478089863001309614674686652597236324659979849324914804032046113978246674538411441434320732570934185579553749616238819583998</span></span><br><span class="line"><span class="comment"># z = 1283646988194723153191718393109711130382429329041718186548715246082834666179475883560020086589684603980734305610989683434078096863563033623169666389076830792095374856743015929373461198718962686411467443788047511292138922700655772772117855226419561159782734009961921473456332468653898105909729309377890721920937410781006337057478451806364879679045839945032594716202888196404203782734864187890231653321470085251</span></span><br><span class="line"><span class="comment"># c = 4988583141177813116287729619098477713529507701428689219486720439476625736884177254107631282807612305211904876847916760967188201601494592359879509876201418493870112712105543214178376471651715703062382025712952561985261461883133695993952914519494709871429166239968478488380137336776740647671348901626710334330855078254188539448122493675463406596681080368929986034772169421577420193671300532508625180845417164660544286332963072804192276425664877337357353975758574262657585309762422727680851018467657523970318042829660721433987195369353660020476598195375492128671951807024027929490113371463210453342974983253996717176870</span></span><br></pre></td></tr></table></figure><h2 id="解"><a href="#解" class="headerlink" title="解"></a>解</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">16063619267258988011034805988633616492558472337115259037200126862563048933118401979462064790962157697989038876156970157178132518189429914950166878537819575544418107719419007799951815657212334175336430766777427972314839713871744747439745897638084891777417411340564312381163685003204182743581513722530953822420925665928135283753941119399766754107671729392716849464530701015719632309411962242638805053491529098780122555818774774959577492378249768503656934696409965037843388835948033129997732058133842695370074265039977902884020467413323500218577769082193651281154702147769044514475692164145099161948955990463002411473013</span></span><br><span class="line">x = <span class="number">3021730035236300354492366560252387204933590210661279960796549263827016146230329262559940840168033978439210301546282150367717272453598367244078695402717500358042032604007007155898199149948267938948641512214616076878271433754986480186150178487625316601499002827958344941689933374158456614113935145081427421623647242719093642478556263121508238995676370877385638074444859047640771188280945186355013165130171802867101829647797879344213688981448535289683363612035513789240264618036062440178755665951650666056478493289870170026121826588708849844053588998886259091357236645819074078054595561158630194224419831088510266212458</span></span><br><span class="line">y = <span class="number">8995787142441643101775260550632842535051686960331455373408888374295557050896156890779515089927839904014859222004906681231525326673182671984194300730575609496770604394218160422560576866112460837985407931067753009696969997384839637927957848613356269534870170452152926447601781637641134982178028922559652443398183848786034348994249923007092159192374765197460466878587635412657807328348343062302127490267456095927890461140420639805398464266081441243108883599713672104446500850203779995739675784794478089863001309614674686652597236324659979849324914804032046113978246674538411441434320732570934185579553749616238819583998</span></span><br><span class="line">z = <span class="number">1283646988194723153191718393109711130382429329041718186548715246082834666179475883560020086589684603980734305610989683434078096863563033623169666389076830792095374856743015929373461198718962686411467443788047511292138922700655772772117855226419561159782734009961921473456332468653898105909729309377890721920937410781006337057478451806364879679045839945032594716202888196404203782734864187890231653321470085251</span></span><br><span class="line">c = <span class="number">4988583141177813116287729619098477713529507701428689219486720439476625736884177254107631282807612305211904876847916760967188201601494592359879509876201418493870112712105543214178376471651715703062382025712952561985261461883133695993952914519494709871429166239968478488380137336776740647671348901626710334330855078254188539448122493675463406596681080368929986034772169421577420193671300532508625180845417164660544286332963072804192276425664877337357353975758574262657585309762422727680851018467657523970318042829660721433987195369353660020476598195375492128671951807024027929490113371463210453342974983253996717176870</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">s = GCD(c - <span class="number">1</span>, n)</span><br><span class="line">m1 = ((z - <span class="number">1</span>) // s) % s</span><br><span class="line">m1 = long_to_bytes(m1)</span><br><span class="line">r3 = y ** <span class="number">3</span> % (n // s)</span><br><span class="line">q = GCD(y - x, n)</span><br><span class="line">p = GCD(x-y-q, n//q)</span><br><span class="line">r = n//(p*q*s)</span><br><span class="line">phi = (q - <span class="number">1</span>)*(p - <span class="number">1</span>)*(r - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert((e * (s - <span class="number">1</span>)) // <span class="number">4</span>, phi)</span><br><span class="line">c_pqr = c % (p*q*r)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c, d, p*q*r)</span><br><span class="line">m2 = gmpy2.iroot(m2, <span class="number">4</span>)</span><br><span class="line">m2 = long_to_bytes(m2[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># print(m1)</span></span><br><span class="line"><span class="comment"># print(m2)</span></span><br><span class="line"><span class="built_in">print</span>(m1+m2)</span><br><span class="line"><span class="comment"># b&#x27;nkctf&#123;cb5b7392-cca4-4ce2-87e7-930cf6b29959&#125;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ez_math </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>coding_note</title>
      <link href="/2024/03/20/codingnote/"/>
      <url>/2024/03/20/codingnote/</url>
      
        <content type="html"><![CDATA[<h2 id="next-permutation"><a href="#next-permutation" class="headerlink" title="next_permutation()"></a>next_permutation()</h2><p>在C++中，<code>std::next_permutation</code> 是一个标准库函数，用于生成序列的下一个排列。这个函数定义在头文件 <code>&lt;algorithm&gt;</code> 中，可以用于遍历一个序列的所有可能的排列。</p><p><code>std::next_permutation</code> 函数的基本用法如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::string s = <span class="string">&quot;ABC&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (std::<span class="built_in">next_permutation</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>())) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;The next permutation is: &quot;</span> &lt;&lt; s &lt;&lt; std::endl;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;There are no more permutations.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这个例子中，<code>std::next_permutation</code> 函数尝试为字符串 <code>s</code> 生成下一个排列。如果成功，函数返回 <code>true</code>，并且 <code>s</code> 会被更新为下一个排列。如果已经是最后一个排列，函数返回 <code>false</code>，<code>s</code> 保持不变。</p><p>函数的参数是序列的开始和结束迭代器。对于数组，可以使用数组的指针或数组的引用作为参数。例如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> arr[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">std::<span class="built_in">next_permutation</span>(arr, arr + <span class="built_in">sizeof</span>(arr) / <span class="built_in">sizeof</span>(arr[<span class="number">0</span>]));</span><br></pre></td></tr></table></figure><p>在使用 <code>std::next_permutation</code> 时，通常将其放在一个循环中，以便遍历序列的所有排列。例如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::vector&lt;<span class="type">int</span>&gt; v = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i : v) &#123;</span><br><span class="line">            std::cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">while</span> (std::<span class="built_in">next_permutation</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>()));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这个例子中，<code>do-while</code> 循环确保了即使在最后一次调用 <code>std::next_permutation</code> 后，循环体内的代码也会执行，从而打印出最后一个排列。然后，<code>std::next_permutation</code> 被调用，尝试生成下一个排列。循环会一直继续，直到所有的排列都被遍历完毕。</p><h2 id="无重复字符的最长子串"><a href="#无重复字符的最长子串" class="headerlink" title="无重复字符的最长子串"></a>无重复字符的最长子串</h2><p>给定一个字符串s，请你找出其中不含有重复字符的最长子串的长度。</p><p>希哈表+快慢指针</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(<span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> result = <span class="number">0</span>, i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> length = <span class="built_in">strlen</span>(s);</span><br><span class="line"><span class="type">int</span> cnt[<span class="number">128</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; length; j++) &#123;</span><br><span class="line">cnt[s[j]]++;</span><br><span class="line"><span class="keyword">if</span> (cnt[s[j]] &gt; <span class="number">1</span>) &#123;<span class="comment">//遇到重复的字母</span></span><br><span class="line">result = result &lt; j - i ? j - i : result;<span class="comment">//计算快慢指针间子串的长度并更新</span></span><br><span class="line">      <span class="comment">//查找第一个重复字母并清零计数</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = i; k &lt; j; k++) &#123;</span><br><span class="line">        cnt[s[k]]--;<span class="comment">//清零第一个重复字母（含）前的计数</span></span><br><span class="line"><span class="keyword">if</span> (s[k] == s[j]) &#123;<span class="comment">//找到第一个重复字母，退出查找循环</span></span><br><span class="line">i = k;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">i++;<span class="comment">//慢指针指向第一个重复字母后的字母</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">result = result &lt; j - i ? j - i : result;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="对一列数排序-火星人"><a href="#对一列数排序-火星人" class="headerlink" title="对一列数排序(火星人)"></a>对一列数排序(火星人)</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n,m;</span><br><span class="line">  <span class="type">int</span> a[<span class="number">10110</span>];</span><br><span class="line">  cin&gt;&gt;n;</span><br><span class="line">  cin&gt;&gt;m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) </span><br><span class="line">  &#123;</span><br><span class="line">    cin&gt;&gt;a[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">next_permutation</span>(a+<span class="number">1</span>,a+<span class="number">1</span>+n);   <span class="comment">//对数组排序传递索引即可</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cout&lt;&lt;a[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="排列序数"><a href="#排列序数" class="headerlink" title="排列序数"></a>排列序数</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//先对输入的字符串进行排列，然后输出全排列的情况，情况想等时结束</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  string s,o;</span><br><span class="line">  cin&gt;&gt;s;</span><br><span class="line">  o=s;</span><br><span class="line">  <span class="built_in">sort</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>());  <span class="comment">//字符串内部排序的实现</span></span><br><span class="line">  <span class="keyword">if</span>(s==o) cout&lt;&lt;<span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">next_permutation</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>()))</span><br><span class="line">  &#123;</span><br><span class="line">    cnt++;</span><br><span class="line">    <span class="keyword">if</span>(s==o)  cout&lt;&lt;cnt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第几个幸运数字"><a href="#第几个幸运数字" class="headerlink" title="第几个幸运数字"></a>第几个幸运数字</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span>  <span class="comment">//cpp实现</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span>   <span class="comment">//暴力搜索</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> n=<span class="number">59084709587505</span>;</span><br><span class="line">  <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;<span class="built_in">pow</span>(<span class="number">3</span>,i)&lt;n;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;<span class="built_in">pow</span>(<span class="number">5</span>,j)&lt;n;j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;<span class="built_in">pow</span>(<span class="number">7</span>,k)&lt;n;k++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="number">3</span>,i)*<span class="built_in">pow</span>(<span class="number">5</span>,j)*<span class="built_in">pow</span>(<span class="number">7</span>,k)&lt;=n)  cnt++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,cnt<span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  <span class="comment"># python实现</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">cnt=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">50</span>):</span><br><span class="line">      a=<span class="number">3</span>**i;b=<span class="number">5</span>**j;c=<span class="number">7</span>**k</span><br><span class="line">      <span class="keyword">if</span> a*b*c&lt;=<span class="number">59084709587505</span>:</span><br><span class="line">        cnt+=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(cnt-<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="奖学金"><a href="#奖学金" class="headerlink" title="奖学金"></a>奖学金</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">stu</span>&#123;    <span class="comment">//定义一个结构体来存储相关数据</span></span><br><span class="line">  <span class="type">int</span> id;</span><br><span class="line">  <span class="type">int</span> c,m,e;</span><br><span class="line">  <span class="type">int</span> sum;</span><br><span class="line">&#125;st[<span class="number">305</span>];  <span class="comment">//n&lt;=300</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(stu a,stu b)</span>   <span class="comment">//定义一个结构体比较的函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a.sum&gt;b.sum)  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(a.sum&lt;b.sum)   <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(a.c&gt;b.c)  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(a.c&lt;b.c)  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(a.id&gt;b.id)  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  cin&gt;&gt;n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    st[i].id=i+<span class="number">1</span>;  <span class="comment">//输入学号</span></span><br><span class="line">    cin&gt;&gt;st[i].c&gt;&gt;st[i].m&gt;&gt;st[i].e;  <span class="comment">//输入三科成绩</span></span><br><span class="line">    st[i].sum=st[i].c+st[i].m+st[i].e;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(st,st+n,cmp);   <span class="comment">//按照结构体比较的方式进行排序</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cout&lt;&lt;st[i].id&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;st[i].sum&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="双向排序"><a href="#双向排序" class="headerlink" title="双向排序"></a>双向排序</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N =<span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="comment">//60%的解法 算法的复杂度为mnlogn</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">int</span> a ,<span class="type">int</span> b)</span>  <span class="comment">//定义降序排列</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a&gt;b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n,m;</span><br><span class="line">  cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)  a[i]=i;   <span class="comment">//先生成数组包含数1-n</span></span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="type">int</span> p,q;</span><br><span class="line">  cin&gt;&gt;p&gt;&gt;q;</span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">1</span>)  <span class="built_in">sort</span>(a+q,a+n+<span class="number">1</span>);<span class="comment">// 升序排列</span></span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">0</span>)  <span class="built_in">sort</span>(a+<span class="number">1</span>,a+q+<span class="number">1</span>,cmp);<span class="comment">//降序排列</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i =<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cout&lt;&lt;a[i]&lt;&lt;<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="错误票据"><a href="#错误票据" class="headerlink" title="错误票据"></a>错误票据</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> m[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  cin&gt;&gt;n;</span><br><span class="line">  <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;m[cnt])!=EOF) cnt++;   <span class="comment">//这里需要关注对输入的处理</span></span><br><span class="line">  <span class="built_in">sort</span>(m,m+cnt);</span><br><span class="line">  <span class="type">int</span> ans1,ans2;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;cnt<span class="number">-1</span>;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(m[i+<span class="number">1</span>]-m[i]&gt;<span class="number">1</span>) ans1=m[i]+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(m[i]==m[i+<span class="number">1</span>])  ans2=m[i];</span><br><span class="line">  &#125;</span><br><span class="line">  cout&lt;&lt;ans1&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;ans2; </span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="统计数字"><a href="#统计数字" class="headerlink" title="统计数字"></a>统计数字</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> m[<span class="number">200010</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;m[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(m,m+n);</span><br><span class="line">  <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cnt++;</span><br><span class="line">    <span class="keyword">if</span>(m[i]!=m[i+<span class="number">1</span>])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,m[i],cnt);</span><br><span class="line">      cnt=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="求和"><a href="#求和" class="headerlink" title="求和"></a>求和</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> n;</span><br><span class="line">  cin&gt;&gt;n;</span><br><span class="line">  <span class="type">int</span> a[<span class="number">200005</span>];</span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> sum=<span class="number">0</span>;</span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> temp=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">    temp +=a[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    temp-=a[i];</span><br><span class="line">    sum += a[i]*temp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,sum);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="782-拼数"><a href="#782-拼数" class="headerlink" title="782 拼数"></a>782 拼数</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//按两个数字组合的字典序排序，就是把数字看成字符串来排序</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(string a,string b)</span>  <span class="comment">//从大到小，按字典序的反序列排列</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a+b&gt;b+a;   <span class="comment">//组合字符串的技巧，这里需要注意</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  cin&gt;&gt;n; </span><br><span class="line">  string a[n];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)  cin&gt;&gt;a[i];</span><br><span class="line">  <span class="built_in">sort</span>(a,a+n,cmp);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) cout&lt;&lt;a[i];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="208-带分数"><a href="#208-带分数" class="headerlink" title="208 带分数"></a>208 带分数</h2><p>这题我不是很会，参考了题解，懂了一点，感觉好复杂啊啊啊啊啊</p><p>仔细看还是很好理解的，就是不太好想到欸，还是自己太菜了。。。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//排列题，9！共有362880种情况，全排列即可，不会超时</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> num[<span class="number">9</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;;</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=a;i&lt;=b;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    sum=sum*<span class="number">10</span>+num[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  cin&gt;&gt;n;</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">next_permutation</span>(num,num+<span class="number">9</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;<span class="number">8</span>;j++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> a=<span class="built_in">func</span>(<span class="number">0</span>,i);</span><br><span class="line">        <span class="type">int</span> b=<span class="built_in">func</span>(i+<span class="number">1</span>,j);</span><br><span class="line">        <span class="type">int</span> c=<span class="built_in">func</span>(j+<span class="number">1</span>,<span class="number">8</span>); <span class="comment">//9个数索引是0到8。。。</span></span><br><span class="line">        <span class="keyword">if</span>(n*c==a*c+b)</span><br><span class="line">        &#123;</span><br><span class="line">          cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  cout&lt;&lt;cnt;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="回文判定（双指针-反向扫描）"><a href="#回文判定（双指针-反向扫描）" class="headerlink" title="回文判定（双指针&#x2F;反向扫描）"></a>回文判定（双指针&#x2F;反向扫描）</h2><p>实现一  for循环</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  string s;</span><br><span class="line">  cin&gt;&gt;s;</span><br><span class="line">  <span class="type">int</span> n=s.<span class="built_in">size</span>();</span><br><span class="line">  <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n/<span class="number">2</span>;i++)</span><br><span class="line">    <span class="keyword">if</span>(s[i]!=s[n-i<span class="number">-1</span>]) cnt++;</span><br><span class="line">  <span class="keyword">if</span>(cnt!=<span class="number">0</span>) cout&lt;&lt;<span class="string">&#x27;N&#x27;</span>;</span><br><span class="line">  <span class="keyword">else</span> cout&lt;&lt;<span class="string">&#x27;Y&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>实现二  for循环加改进</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  string s;</span><br><span class="line">  cin&gt;&gt;s;</span><br><span class="line">  <span class="type">int</span> n=s.<span class="built_in">size</span>();</span><br><span class="line">  <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n/<span class="number">2</span>;i++)</span><br><span class="line">    <span class="keyword">if</span>(s[i]!=s[n-i<span class="number">-1</span>]) </span><br><span class="line">    &#123;</span><br><span class="line">      cout&lt;&lt;<span class="string">&#x27;N&#x27;</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">//这里通过return 0可以实现直接结束程序</span></span><br><span class="line">    &#125;</span><br><span class="line">  cout&lt;&lt;<span class="string">&#x27;Y&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>实现三  使用while循环</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  string s;</span><br><span class="line">  cin&gt;&gt;s;</span><br><span class="line">  <span class="type">int</span> n=s.<span class="built_in">size</span>();</span><br><span class="line">  <span class="type">int</span> i=<span class="number">0</span>,j=n<span class="number">-1</span>;  <span class="comment">//双指针</span></span><br><span class="line">  <span class="keyword">while</span>(i&lt;j)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(s[i]!=s[j])</span><br><span class="line">    &#123;</span><br><span class="line">      cout&lt;&lt;<span class="string">&#x27;N&#x27;</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    i++,j--;</span><br><span class="line">  &#125;</span><br><span class="line">  cout&lt;&lt;<span class="string">&#x27;Y&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2024_VCTF_crypto_狂飙</title>
      <link href="/2024/03/18/2024-vctf-crypto-kuang-biao/"/>
      <url>/2024/03/18/2024-vctf-crypto-kuang-biao/</url>
      
        <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">m = <span class="number">88007513702424243702066490849596817304827839547007641526433597788800212065249</span></span><br><span class="line">key = os.urandom(<span class="number">24</span>)</span><br><span class="line">key = bytes_to_long(key)</span><br><span class="line">n=m % key</span><br><span class="line">flag += (<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>) * <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">enc_flag = aes.encrypt(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(enc_flag)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#103560843006078708944833658339172896192389513625588</span></span><br><span class="line"><span class="comment">#b&#x27;\xfc\x87\xcb\x8e\x9d\x1a\x17\x86\xd9~\x16)\xbfU\x98D\xfe\x8f\xde\x9c\xb0\xd1\x9e\xe7\xa7\xefiY\x95C\x14\x13C@j1\x9d\x08\xd9\xe7W&gt;F2\x96cm\xeb&#x27;</span></span><br><span class="line"><span class="comment">#b&#x27;UN\x1d\xe2r&lt;\x1db\x00\xdb\x9a\x84\x1e\x82\xf0\x86&#x27;</span></span><br></pre></td></tr></table></figure><p>由已知我们可以得到</p><p>m-s*key &#x3D; n</p><p>将 m-n 分解即可得到 s*key 的组合</p><p>根据一个字节 8 位，得到 key 为 192 位</p><p>然后可以利用 sage 进行爆破即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">103560843006078708944833658339172896192389513625588</span></span><br><span class="line">m = <span class="number">88007513702424243702066490849596817304827839547007641526433597788800212065249</span></span><br><span class="line">key = m-n</span><br><span class="line"><span class="comment"># 88007513702424243702066490746035974298749130602173983187260701596410698439661</span></span><br><span class="line">enc = <span class="string">b&#x27;\xfc\x87\xcb\x8e\x9d\x1a\x17\x86\xd9~\x16)\xbfU\x98D\xfe\x8f\xde\x9c\xb0\xd1\x9e\xe7\xa7\xefiY\x95C\x14\x13C@j1\x9d\x08\xd9\xe7W&gt;F2\x96cm\xeb&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;UN\x1d\xe2r&lt;\x1db\x00\xdb\x9a\x84\x1e\x82\xf0\x86&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> key.divisors():</span><br><span class="line">    i=long_to_bytes(i,<span class="number">24</span>)</span><br><span class="line">    aes=AES.new(i,AES.MODE_CBC,iv)</span><br><span class="line">    flag=aes.decrypt(enc)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#123;&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gmpy2库的常用函数总结</title>
      <link href="/2024/03/11/gmpy2-ku-de-chang-yong-han-shu-zong-jie/"/>
      <url>/2024/03/11/gmpy2-ku-de-chang-yong-han-shu-zong-jie/</url>
      
        <content type="html"><![CDATA[<h2 id="gmpy2"><a href="#gmpy2" class="headerlink" title="gmpy2"></a>gmpy2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">gmpy2.mpz(n)                <span class="comment"># 初始化一个大整数</span></span><br><span class="line">gmpy2.mpfr(x)               <span class="comment"># 初始化一个高精度浮点数x</span></span><br><span class="line">d = gmpy2.invert(e, n)      <span class="comment"># 求逆元，de = 1 mod n  模反元素</span></span><br><span class="line">C = gmpy2.powmod(M, e, n)   <span class="comment"># 幂取模，结果是 C = (M^e) mod n</span></span><br><span class="line">gmpy2.is_prime(n)           <span class="comment"># 素性检测</span></span><br><span class="line">gmpy2.gcd(a, b)             <span class="comment"># 欧几里得算法，最大公约数</span></span><br><span class="line">gmpy2.gcdext(a, b)          <span class="comment"># 扩展欧几里得算法</span></span><br><span class="line">gmpy2.iroot(x, n)           <span class="comment"># x开n次根</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>WP_2024HSCCTF_CRYPTO_STAR_CHASING_DIARY</title>
      <link href="/2024/03/10/wp-2024hscctf-crypto-star-chasing-diary/"/>
      <url>/2024/03/10/wp-2024hscctf-crypto-star-chasing-diary/</url>
      
        <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">小肖在学习的过程中,了解到了一种填充图片的算法,兴奋的她用它和RSA加密了偶像的照片,</span></span><br><span class="line"><span class="string">但是在传输的过程中丢失了一部分加密算法,你能帮她补全,并解出来偶像的照片吗?</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">n, x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    m = <span class="number">1</span> &lt;&lt; (n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">j = <span class="number">128</span></span><br><span class="line">mm = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">257</span>):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">257</span>):</span><br><span class="line">        mm.append(f(j, i, s) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;flag.jpg&#x27;</span>)</span><br><span class="line">pixels = <span class="built_in">list</span>(img.getdata())</span><br><span class="line">data = [pixel <span class="keyword">for</span> pixel <span class="keyword">in</span> pixels]</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;key.png&#x27;</span>)</span><br><span class="line">pixels = <span class="built_in">list</span>(img.getdata())</span><br><span class="line">png_key = [pixel <span class="keyword">for</span> pixel <span class="keyword">in</span> pixels]</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0</span>] * <span class="number">65536</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    enc[i] = data[mm[i]]</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    enc[s] = enc[s] ^ png_key[s]</span><br><span class="line"></span><br><span class="line">image = Image.new(<span class="string">&#x27;L&#x27;</span>, (<span class="number">256</span>, <span class="number">256</span>))</span><br><span class="line">image.putdata(enc)</span><br><span class="line">image.save(<span class="string">&#x27;enc.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure><p>一张图片 enc.ipg</p><p><img src="https://pic.imgdb.cn/item/65ed83e99f345e8d039b761d.jpg" alt="alt text"></p><p>还有一个压缩包</p><p>另外一个解密压缩包密码的文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q =&quot;</span>, q)</span><br><span class="line">n = p * q</span><br><span class="line">key = <span class="string">&#x27;********************&#x27;</span></span><br><span class="line">m = bytes_to_long(key.encode())</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">300</span></span><br><span class="line">r = randint(<span class="number">1</span>, n)</span><br><span class="line">c = (<span class="built_in">pow</span>(n + <span class="number">1</span>, m, n * n) * <span class="built_in">pow</span>(r, n, n * n)) % (n * n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = 7828612943367317778189697443061863547768704021648982642807960201410438190347546379219450386530108335470584219657007036386835647156694512102467911388214639</span></span><br><span class="line"><span class="comment"># q = 11560196429251786803557082533869761370530605728500211999842201987445533038949033226473164866960007192683170489064961432891988337343103657552186800680461299</span></span><br><span class="line"><span class="comment"># c = 768905250861905487717845092484035532140840941871031779930259407348955511757335716790249355464829607714399266689960353955065504221985891074636544161678177920296971444880997864168042745264256952808480926755620637239135808617643874771066244234690401223758004286234917537720362007827248701308605961814972773704288547887039586934111562590676930853945316673164146667949991176600280451163710564978897622310650541491271961315592017251211248379608602287809736613530069187936569470129814949302440734244885473716072898519354127964155042421376782226235081303957997587618278341829891036314980185040102049478608445519994654780162</span></span><br></pre></td></tr></table></figure><h2 id="解"><a href="#解" class="headerlink" title="解"></a>解</h2><p>这是一个 Paillier 加密，参考</p><p><a href="https://zhuanlan.zhihu.com/p/106340045">https://zhuanlan.zhihu.com/p/106340045</a></p><p>解密分为以下几个步骤：</p><p>生成私钥： 私钥包含两个大质数 p 和 q。在本题中，p 和 q 已经给出了。</p><p>计算 Carmichael λ 函数的值：其中 λ(n) &#x3D; lcm(p-1, q-1)，lcm 是最小公倍数函数。</p><p>计算 μ： μ 是 n 的欧拉函数的模反元素，满足 </p><p>(L(g^λ(n) mod n^2))^-1 mod n</p><p>其中</p><p>L(x) &#x3D; (x - 1) &#x2F; n</p><p>g 是一个随机选择的整数且满足</p><p>gcd(L(g^λ(n) mod n^2), n) &#x3D; 1</p><p>解密密文： 密文 c 可以通过以下公式计算得到明文 m：</p><p>m &#x3D; L(c^λ(n) mod n^2) * μ mod n</p><p>代码参考：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line">p = <span class="number">7828612943367317778189697443061863547768704021648982642807960201410438190347546379219450386530108335470584219657007036386835647156694512102467911388214639</span></span><br><span class="line">q = <span class="number">11560196429251786803557082533869761370530605728500211999842201987445533038949033226473164866960007192683170489064961432891988337343103657552186800680461299</span></span><br><span class="line">c = <span class="number">768905250861905487717845092484035532140840941871031779930259407348955511757335716790249355464829607714399266689960353955065504221985891074636544161678177920296971444880997864168042745264256952808480926755620637239135808617643874771066244234690401223758004286234917537720362007827248701308605961814972773704288547887039586934111562590676930853945316673164146667949991176600280451163710564978897622310650541491271961315592017251211248379608602287809736613530069187936569470129814949302440734244885473716072898519354127964155042421376782226235081303957997587618278341829891036314980185040102049478608445519994654780162</span></span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算λ(n)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcm</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(a*b) // math.gcd(a, b)</span><br><span class="line"></span><br><span class="line">lambda_n = lcm(p-<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算μ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_inverse</span>(<span class="params">a, m</span>):</span><br><span class="line">    m0, x0, x1 = m, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> a &gt; <span class="number">1</span>:</span><br><span class="line">        q = a // m</span><br><span class="line">        m, a = a % m, m</span><br><span class="line">        x0, x1 = x1 - q * x0, x0</span><br><span class="line">    <span class="keyword">return</span> x1 + m0 <span class="keyword">if</span> x1 &lt; <span class="number">0</span> <span class="keyword">else</span> x1</span><br><span class="line"></span><br><span class="line">mu = mod_inverse(lambda_n, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密密文</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c, lambda_n, n, mu</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(c, lambda_n, n*n) - <span class="number">1</span>) // n * mu % n</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="number">768905250861905487717845092484035532140840941871031779930259407348955511757335716790249355464829607714399266689960353955065504221985891074636544161678177920296971444880997864168042745264256952808480926755620637239135808617643874771066244234690401223758004286234917537720362007827248701308605961814972773704288547887039586934111562590676930853945316673164146667949991176600280451163710564978897622310650541491271961315592017251211248379608602287809736613530069187936569470129814949302440734244885473716072898519354127964155042421376782226235081303957997587618278341829891036314980185040102049478608445519994654780162</span></span><br><span class="line"></span><br><span class="line">plaintext = decrypt(ciphertext, lambda_n, n, mu)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;明文为:&quot;</span>, long_to_bytes(plaintext))</span><br><span class="line"><span class="comment"># 明文为: b&#x27;HSCCTF&#123;this_is_a_fake_flag&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>得到的 flag 为压缩包的密码，打开压缩包，发现了另外半份图片 key.png<br><img src="https://pic.imgdb.cn/item/65ed838c9f345e8d03996bca.png" alt="alt text"></p><p>下面的首要问题是补全这个加密函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">n, x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    m = <span class="number">1</span> &lt;&lt; (n - <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 这里少了一句话</span></span><br></pre></td></tr></table></figure><p>出题人用这个函数来对两张图片 flag.jpg 和 key.png 的像素点进行异或得到了 enc.jpg</p><p>但是这个函数我不知道是什么。。。。</p><p>over !</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>WP_2024HSCCTF_CRYPTO_MIXED</title>
      <link href="/2024/03/10/wp-2024hscctf-crypto-mixed/"/>
      <url>/2024/03/10/wp-2024hscctf-crypto-mixed/</url>
      
        <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">q1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">p1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">n1 = q * p1</span><br><span class="line">n2 = p * q1</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">h0 = <span class="built_in">pow</span>(<span class="number">2023</span> * p + <span class="number">2024</span>, q1, n2)</span><br><span class="line">h1 = <span class="built_in">pow</span>(<span class="number">2024</span> * p1 + <span class="number">2023</span> * q, <span class="number">114</span>, n1)</span><br><span class="line">h2 = <span class="built_in">pow</span>(<span class="number">2023</span> * p1 + <span class="number">2024</span> * q, <span class="number">514</span>, n1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n1 = <span class="subst">&#123;n1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n2 = <span class="subst">&#123;n2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h0 = <span class="subst">&#123;h0&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h1 = <span class="subst">&#123;h1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h2 = <span class="subst">&#123;h2&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n1 = 14689930167621480307737218855980844793204825453111553640005733004311399091452749419195261723160562669712981077205514482387428543859060408330555457873612388970840075555219318724209919379670375754436986322725018229701175825510253987615017542205904982728558285520666278391637251512741084978804344612886660251741043298476839942441197788722691248949008018299101517153067904692310160459839327965213126456776042470327923603098133019640956702820908299859534676381094974148722668171932091455546601087513513432342088579253210930555185169910878657816252698605590059713584044287411998445279104965229112287195772355914014694372863</span></span><br><span class="line"><span class="comment"># n2 = 17914624231045471060767877283214815212078805279600237578901916178851704643026979522270658635212967285131654546207286875722198040564094351690066028556053274118826426726436922152056884333790850220488793722836758989770231697392015361745717234225528175411653330848965062023338707342188196332661335758350340958332400847642883219650661408895191363079017750144776587598058350920393498114498603046807597288603882782473322630631915467470131090200369527436760313289344813744004003957932606166823948354564464154141854938585629799995141656546295799610158824771809513458197812936595649326475123400845178122171317543843802357238737</span></span><br><span class="line"><span class="comment"># c = 13183645788828584902734975771833842634134772971197066374278716198331982362845597338541987579827576129126962300555023319276896080171662261983323670516457816608069076576704379871559881585100353737989915143190277856145677733747073530969459479608854483866886381406790221076900624083605418670450439523062190633487764982399334967431524831264337949814367905185282600511829794170139623625545288981992093108619556180352620171550284923452864402624195790781899415138548827684042790774382313520961335293225295922563245148598807498320652973409239921962292395269739151692443069186695137458774227330748775469621908962878548784542656</span></span><br><span class="line"><span class="comment"># h0 = 5690435858632801053001568276569200811072324786394351282330736437777643891675713760267573500875018036769819201228707494676033534733516436880434000381152290529934127584047681184797730806321117079578438213106595566102910231831641994870770844810797745935336962801658360541755214075101149142486964461669833043007174173934693214526552375910644574723526164021660497474760514459351270699055076380763188021265735007339272243426286470006040246926184305520860068095134003662496837644875879106318233600478000160450338727054920011063536387532763661934972965357326471012678550188382945584128136131833085006239075931753900705852481</span></span><br><span class="line"><span class="comment"># h1 = 12771704142231361356944931328203992824809472923288035056741145310446323135378739806430357600688780862532180394967607429708811767590541126019805423171023560973250443508427614362854583240402451944730512334908779225174763498122005198084487562912524477476241978066554026569609494641830034817298185887790987627444544391680388213205514284116732325350187204519755399841372144149840914651521842402817701298224803289451378581226204084757079457612984358925767378458994608562174048729806309230061089552045138514542758457243626150673888166620841134063713151240297774551489301504222933127458884374866611598279831562420720169790688</span></span><br><span class="line"><span class="comment"># h2 = 10768269134499905916388929049595509895751098112372323618798542159569174051578701710549609054808995774168931375186213550074900373023970882450822655786787740452681278837907191091338575561570211280095894576674089666981683405385847773819238581725093823429776684561667462626941518248024517707992035438082636259838822562843169441572048956484831730615047363383911454662789736761572912893234212875097536978423758275178050708616505311352511923810654873380808201395656416903900326634569672173228265730515727327832588326581592485713225927319225942965110285477266200380452637746037672411388696006933080509164615786616058664496851</span></span><br></pre></td></tr></table></figure><h2 id="解"><a href="#解" class="headerlink" title="解"></a>解</h2><p>本题可以看成一个混合加密的缝合怪，将几道类似的题目拼接到了一起，下面先放参考别的师傅写的WP</p><p><a href="https://www.cnblogs.com/mumuhhh/p/17783610.html">https://www.cnblogs.com/mumuhhh/p/17783610.html</a></p><p>具体而言分成了两个解密题，作用为别为求解p和q</p><p>第一个为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">h0 = <span class="built_in">pow</span>(<span class="number">2023</span> * p + <span class="number">2024</span>, q1, n2)</span><br></pre></td></tr></table></figure><p>上述公式中发现只有一个未知数（p和q1可以看成一个未知数）<br>因此理论上可以轻松解出，实际上应该也不难。。。具体使用到了费马定理，前面已经讲过，化简后一行代码即可解决</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p = gmpy2.gcd(h0-<span class="built_in">pow</span>(<span class="number">2024</span>,n2,n2),n2)</span><br></pre></td></tr></table></figure><p>第二个为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">h1 = <span class="built_in">pow</span>(<span class="number">2024</span> * p1 + <span class="number">2023</span> * q, <span class="number">114</span>, n1)</span><br><span class="line">h2 = <span class="built_in">pow</span>(<span class="number">2023</span> * p1 + <span class="number">2024</span> * q, <span class="number">514</span>, n1)</span><br></pre></td></tr></table></figure><p>两个未知数（p1、q）,两个方程，理论上也能解决</p><p>但实际上这个要复杂一点点。。。</p><p>原理不是很懂，但是可以简单讲讲过程</p><p>首先需要求解一个叫k的东西，这个k与114和514这两个数有关，具体而言</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k = <span class="number">2</span>*<span class="number">57</span>*<span class="number">257</span></span><br></pre></td></tr></table></figure><p>如何计算的呢？</p><p>2代表的含义是114和514的最大公因数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>=gmpy2.gcd(<span class="number">114</span>, <span class="number">514</span>)</span><br></pre></td></tr></table></figure><p>然后57是114与2的商，257是514与2的商</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">57</span>=<span class="number">114</span>//<span class="number">2</span></span><br><span class="line"><span class="number">257</span>=<span class="number">514</span>//<span class="number">2</span></span><br></pre></td></tr></table></figure><p>知道了k之后就可以带入计算了，具体模板如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">h5 = <span class="built_in">pow</span>(h1,<span class="number">257</span>,n)*<span class="built_in">pow</span>(<span class="number">2023</span>,k,n)-<span class="built_in">pow</span>(h2,<span class="number">57</span>,n)*<span class="built_in">pow</span>(<span class="number">2024</span>,k,n)</span><br><span class="line">h6 = <span class="built_in">pow</span>(h1,<span class="number">257</span>,n)*<span class="built_in">pow</span>(<span class="number">2024</span>,k,n)-<span class="built_in">pow</span>(h2,<span class="number">57</span>,n)*<span class="built_in">pow</span>(<span class="number">2023</span>,k,n)</span><br><span class="line">k1 = inverse(<span class="built_in">pow</span>(<span class="number">2023</span>,<span class="number">2</span>*k,n)-<span class="built_in">pow</span>(<span class="number">2024</span>,<span class="number">2</span>*k,n), n)</span><br><span class="line">k2 = inverse(<span class="built_in">pow</span>(<span class="number">2024</span>,<span class="number">2</span>*k,n)-<span class="built_in">pow</span>(<span class="number">2023</span>,<span class="number">2</span>*k,n), n)</span><br><span class="line">h3 = h5 * k1 % n</span><br><span class="line">h4 = h6 * k2 % n</span><br><span class="line">q = GCD(h3, n)</span><br></pre></td></tr></table></figure><p>求出p、q之后就可以解密了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">n = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><p>over!</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HSCCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP_2024HSCCTF_CRYPTO_SING_IN</title>
      <link href="/2024/03/10/wp-2024hscctf-crypto-sing-in/"/>
      <url>/2024/03/10/wp-2024hscctf-crypto-sing-in/</url>
      
        <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;HSCCTF&#123;66666666666666666666666666666666666&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">g, r1, r2, k1, k2 = [randint(<span class="number">1</span>, n) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">g1 = powmod(g, r1 * (p - <span class="number">1</span>), n)</span><br><span class="line">g2 = powmod(g, r2 * (q - <span class="number">1</span>), n)</span><br><span class="line">c1 = m * powmod(g1, k1, n) % n</span><br><span class="line">c2 = m * powmod(g2, k2, n) % n</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc=&#x27;</span>, [c1, c2])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n, g1, g1=&#x27;</span>, [n, g1, g2])</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">enc= [15258813801182767957948809411445530114743580005667897427534365589851124401953952700888032330082278736578651674105204553630115929829327520950316902504433079359916257355896937562916556083469602985115254272625361902512966905366505705193603115063442567259505806926885597909346860116511116593562896739734663097631870026814495999405532329662713707140991693625596972404484374296588505369466138353714461787853643947646268147993568111775200297788443085689323703846485412670213780175163562460311256388185948613714551169278328397181176821021494625532973065606678522088011055084956579073665474553688838705105692370860815836968744, 6812252973072040071827764212287068485224506664962923279994614164374840095630460681859406585838865259535150445414577263383839286602668872146630568583093203237350230531896113453730563536559780725054737930704052263836882704963528437893607940373145674848731274193348770450738356162141551719346994698149112827383011042635625991946491545698464513315705253441372356270248537025391519052228332747340090073726648071921053097612521949040588826684887577900030607964457543549015338544684381220552952995724701579427363382069065679545196826947900332605250858694574423497096207350532949517663416877954484913664168104807510052994343]</span></span><br><span class="line"><span class="string">n, g1, g1= [20807018344486474639307429177279931766730766338068107239915507489300098048895435781756514265069820029246382818970733268271541419058569567895618666922180270584064313671561310704041755422624879418184008100473568396190523033929320245716340019444764233261191278982354931492880877566550189410854395486995604287009460090861952156686772486228583819235930673806632618770875593810617784176409247510465542253043645164164225524491704753384493817563203956665022724674535516870726747405974392352500432805602085261375142216501656342533659731098891481615791354504343987459436489040377662127479793769523359343534307819013289699807101, 13669954919111873554762685722926885077118528999414402163291237939605095249827361266585404348819936899557500751307328088850133462100189908649705354225171362748567332828733792410877365393472368767642223613483944864421225366984013053159643284842823692865975521013400160643858123645513020647367033022539177063702511618272018019345686324322865461583030805528508961559861228807898458344763909703624723082316946660539208262816734999777236686904487167545596412866146192769859422435979617441355968077981338491466670291310491623996943880557071723073298267310617017933994938481600905833829730599911183096116409487608858717083764, 16004755272896973088305242134835363565950101667041191767091338528075710730690484241256646402124331734165332717221873300040844257120250717798419429003342474882969292183331631773486056363790119500409511338474885148624744719334829519138941747721940978742668429331169327121848561577357339194970483392418062307133642660625962426570987080348107999849220769541832138719358407833846252908305766546561532003650472770370573552424932908544299331489147220956574184822433945571318688467182365231955276573176433559755313822566687880866791301904461559170416753669109833335824210853322226762705537051009387847122221014380228383127427]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>目测需要解决的问题是求出p和q，但是n无法分解，陷入沉思。。。后来不小心找到了这道题的原型</p><h2 id="V-N2020-公开赛-Fast"><a href="#V-N2020-公开赛-Fast" class="headerlink" title="[V&amp;N2020 公开赛] Fast"></a>[V&amp;N2020 公开赛] Fast</h2><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">N = p * q</span><br><span class="line"></span><br><span class="line">g, r1, r2 = [getRandomRange(<span class="number">1</span>, N) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">g1 = <span class="built_in">pow</span>(g, r1 * (p-<span class="number">1</span>), N)</span><br><span class="line">g2 = <span class="built_in">pow</span>(g, r2 * (q-<span class="number">1</span>), N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m</span>):</span><br><span class="line">    s1, s2 = [getRandomRange(<span class="number">1</span>, N) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">    c1 = (m * <span class="built_in">pow</span>(g1, s1, N)) % N</span><br><span class="line">    c2 = (m * <span class="built_in">pow</span>(g2, s2, N)) % N</span><br><span class="line">    <span class="keyword">return</span> (c1, c2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c1, c2</span>):</span><br><span class="line">    xp = c1 % p</span><br><span class="line">    xq = c2 % q</span><br><span class="line">    <span class="comment"># Chinese Remainder Theorem</span></span><br><span class="line">    m = (xp*inverse(q, p)*q + xq*inverse(p, q)*p) % N</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = encrypt(bytes_to_long(flag))</span></span><br><span class="line"></span><br><span class="line">N = <span class="number">18680643069610062851842282268594530254220611012409807422663284548187050713427682950720783343430650669361838067625768840896513125210105582070603021732086193955893838077699465426052925750736212977005683541174195320832791835197114668838654054444342903298662698415765898335350206380896849522280206304272801325820946987172164086644949521111058774180676742851681476123338557138770304164634321305204827406522957769478330124484710532963132900017800651579612646041955628867746525508376194147796920773364680264059390497210260540079810501777507814448518995581208169818764701641258963569599247156932381367802991222265241699715283</span></span><br><span class="line">g1 = <span class="number">9143176283300810019842153344177123108612540016879643936458724056602746667157014763960725115919119704406826965726023263657276550779443988565368344040505696950820899770544814163379169539926317676679421275092688200844094929042154854719312788471536324082041360841253720783220459009201882865091829118575721525038404689868986360373373122049951274015083845966946475469982961355934516388706446794517870569063777231434618411404965077775991870069073539415961610645268985004687402050059891500490949250730689691141954694508001895390336750734542724392709744200091587065816283592253967715080611459937165344139809223328071517060208</span></span><br><span class="line">g2 = <span class="number">14068322834597276347776814624877614869834816383564391664570268934537693322688875343215293618493363798985047779057952636529313879548457643220996398640913517182122425631198219387988691569709691279442005545716133131472147592456812502863851227108284027033557263611949365667779259585770738623603814004666845554284808166195201470503432803440754207350347128045893594280079379926676477680556845095378093693409219131090910168117334308781843178748431526974047817218228075136005979538773141427004682344298827618677773735288946271346252828348742296301538573408254015281232250841148556304927266143397565889649305095857756884049430</span></span><br><span class="line">c1, c2 = (<span class="number">3976514029543484086411168675941075541422870678409709261442618832911574665848843566949154289825219682094719766762966082440586568781997199077781276145091509192208487682443007457513002005089654365915817414921574344557570444253187757317116858499013550050579856269915915792827620535138057468531410166908365364129001407147467636145589396570815405571923148902993581000542566387654639930651683044853608873583911638108204074537952317056718986683846742909366072461130053275195290631718363272923316002049685111871888148244026652658482359335651889139243735138819453744763293112267738369048641158946411500606588429007794613880534</span>, <span class="number">18524535479582837341745231233387403662294605513261199630593257391163433751052467785080620993007681605662927226603747560698627838567782891522546977611597418150309028806158429831471152782211111046118637630899456903846057977815397285171313888516791822545633820066408276065732715348834255021260666966934592884548856831383262013360819013814149529393178712576141627031723067564594282618223686778534522328204603249125537258294561872667849498796757523663858312311082034700705599706428944071848443463999351872482644584735305157234751806369172212650596041534643187402820399145288902719434158798638116870325144146218568810928344</span>)</span><br></pre></td></tr></table></figure><p>这题给了解密函数，简单了许多。根据解密函数，只要知道c1、c2、p、q就能求出m。因为c1、c2是已知的，所以求p和q即可</p><p>根据加密的过程，与p，q有关系的语句只有这两个：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g1 = <span class="built_in">pow</span>(g, r1 * (p-<span class="number">1</span>), N)</span><br><span class="line">g2 = <span class="built_in">pow</span>(g, r2 * (q-<span class="number">1</span>), N)</span><br></pre></td></tr></table></figure><p>接下来的推导我也没学过，就当懂了吧。。。</p><p>只看第一个式子：</p><h4 id="g-r1-p-1-mod-p-q-g1"><a href="#g-r1-p-1-mod-p-q-g1" class="headerlink" title="(g^r1)^(p-1) mod p*q &#x3D; g1"></a>(g^r1)^(p-1) mod p*q &#x3D; g1</h4><p>两边同模p：</p><h4 id="g-r1-p-1-mod-p-g1-mod-p"><a href="#g-r1-p-1-mod-p-g1-mod-p" class="headerlink" title="(g^r1)^(p-1) mod p &#x3D; g1 mod p"></a>(g^r1)^(p-1) mod p &#x3D; g1 mod p</h4><p>根据费马小定理（这个可以有）：</p><h4 id="a-（p-1）≡1（mod-p）"><a href="#a-（p-1）≡1（mod-p）" class="headerlink" title="a^（p-1）≡1（mod p）"></a>a^（p-1）≡1（mod p）</h4><p>带入公式显然有：</p><h4 id="g1-mod-1-p"><a href="#g1-mod-1-p" class="headerlink" title="g1 mod 1 &#x3D; p"></a>g1 mod 1 &#x3D; p</h4><p>简单转换一下就有：</p><h4 id="gcd-g1-1-p-q-p"><a href="#gcd-g1-1-p-q-p" class="headerlink" title="gcd(g1-1,p*q)&#x3D;p"></a>gcd(g1-1,p*q)&#x3D;p</h4><p>结合上述推导过程，我们可以得出一下结论：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcd(g1-<span class="number">1</span>,p*q)=p</span><br><span class="line">gcd(g2-<span class="number">1</span>,p*q)=q</span><br></pre></td></tr></table></figure><p>因此可以使用g1,g2和n来求得p和q，与加密过程中的随机质数无关</p><h2 id="解"><a href="#解" class="headerlink" title="解"></a>解</h2><p>利用上述结论以及母题提供的解密函数，构建如下解密脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c1, c2</span>):</span><br><span class="line">    xp = c1 % p</span><br><span class="line">    xq = c2 % q</span><br><span class="line">    <span class="comment"># Chinese Remainder Theorem</span></span><br><span class="line">    m = (xp*inverse(q, p)*q + xq*inverse(p, q)*p) % N</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">N = <span class="number">20807018344486474639307429177279931766730766338068107239915507489300098048895435781756514265069820029246382818970733268271541419058569567895618666922180270584064313671561310704041755422624879418184008100473568396190523033929320245716340019444764233261191278982354931492880877566550189410854395486995604287009460090861952156686772486228583819235930673806632618770875593810617784176409247510465542253043645164164225524491704753384493817563203956665022724674535516870726747405974392352500432805602085261375142216501656342533659731098891481615791354504343987459436489040377662127479793769523359343534307819013289699807101</span></span><br><span class="line">g1 = <span class="number">13669954919111873554762685722926885077118528999414402163291237939605095249827361266585404348819936899557500751307328088850133462100189908649705354225171362748567332828733792410877365393472368767642223613483944864421225366984013053159643284842823692865975521013400160643858123645513020647367033022539177063702511618272018019345686324322865461583030805528508961559861228807898458344763909703624723082316946660539208262816734999777236686904487167545596412866146192769859422435979617441355968077981338491466670291310491623996943880557071723073298267310617017933994938481600905833829730599911183096116409487608858717083764</span></span><br><span class="line">g2 = <span class="number">16004755272896973088305242134835363565950101667041191767091338528075710730690484241256646402124331734165332717221873300040844257120250717798419429003342474882969292183331631773486056363790119500409511338474885148624744719334829519138941747721940978742668429331169327121848561577357339194970483392418062307133642660625962426570987080348107999849220769541832138719358407833846252908305766546561532003650472770370573552424932908544299331489147220956574184822433945571318688467182365231955276573176433559755313822566687880866791301904461559170416753669109833335824210853322226762705537051009387847122221014380228383127427</span></span><br><span class="line">c1, c2 = [<span class="number">15258813801182767957948809411445530114743580005667897427534365589851124401953952700888032330082278736578651674105204553630115929829327520950316902504433079359916257355896937562916556083469602985115254272625361902512966905366505705193603115063442567259505806926885597909346860116511116593562896739734663097631870026814495999405532329662713707140991693625596972404484374296588505369466138353714461787853643947646268147993568111775200297788443085689323703846485412670213780175163562460311256388185948613714551169278328397181176821021494625532973065606678522088011055084956579073665474553688838705105692370860815836968744</span>, <span class="number">6812252973072040071827764212287068485224506664962923279994614164374840095630460681859406585838865259535150445414577263383839286602668872146630568583093203237350230531896113453730563536559780725054737930704052263836882704963528437893607940373145674848731274193348770450738356162141551719346994698149112827383011042635625991946491545698464513315705253441372356270248537025391519052228332747340090073726648071921053097612521949040588826684887577900030607964457543549015338544684381220552952995724701579427363382069065679545196826947900332605250858694574423497096207350532949517663416877954484913664168104807510052994343</span>]</span><br><span class="line">p=gcd(N,g1-<span class="number">1</span>)</span><br><span class="line">q=gcd(N,g2-<span class="number">1</span>)</span><br><span class="line">m=decrypt(c1,c2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>over!</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SING_IN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP_2024PearlCTF_CRYPTO_3spies</title>
      <link href="/2024/03/09/wp-2024pearlctf-crypto-3spies/"/>
      <url>/2024/03/09/wp-2024pearlctf-crypto-3spies/</url>
      
        <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>一个加密脚本: encrypt.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n1 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">n2 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">n3 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">e=<span class="number">3</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e,n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e,n2)</span><br><span class="line">c3 = <span class="built_in">pow</span>(m,e,n3)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;encrypted-messages.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&#x27;n1: <span class="subst">&#123;n1&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;e: <span class="subst">&#123;e&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;c1: <span class="subst">&#123;c1&#125;</span>\n\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;n2: <span class="subst">&#123;n2&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;e: <span class="subst">&#123;e&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;c2: <span class="subst">&#123;c2&#125;</span>\n\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;n3: <span class="subst">&#123;n3&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;e: <span class="subst">&#123;e&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;c3: <span class="subst">&#123;c3&#125;</span>\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>一个文本文件：encrypted-messages.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">n1: 125267411676839013904356880992044234494446196964982422223130579882047339346910691451497681975351838034684254305738613386927222900898672184001345811471784343779083336010063097729870079645284178978512325038316112509718505547104307526489798594871208559607331790920412305711830820739308995357441030646151241475357</span><br><span class="line">e: 3</span><br><span class="line">c1: 53377681151597930200174280269480737905892580547675095951568028531545776989476273786562435486230550919422086944133253611872983670236114054374565938184593173194919064517779661178744278071496565181181705071524501841159717567250259220092464925447795412484629687708208662079791459184303259833667333882817260906165</span><br><span class="line"></span><br><span class="line">n2: 101985110329687359982214188967281711679876126442294375297547334583432698756724057183438691227371260175904715854057793173086301783390154807726779286131084537704721881438398569476214173211311977143694032174701007005033830070482491565424683664984059187439768982994371382763048098663670188786016786612348042190633</span><br><span class="line">e: 3</span><br><span class="line">c2: 86370003324603283962938004647941072863866893771153362222202759619566185050496089684606274416415418388916028237984708280964054009059814813483639010674182298294505525549842057730933691736372086557397211586739691237738757897947336698446258197604918828646265244195686107866422922575275382813594250335044143485624</span><br><span class="line"></span><br><span class="line">n3: 83259448903366278561128205003734328779222118906091604625605804813528274055482582431201682767294594942491788720967344243567819654813240542076250030802111361571504667752481579915864184180358691091092122509649590043074189547962292835856503625214027405901620103615424259796442446412031011575671410630232956892267</span><br><span class="line">e: 3</span><br><span class="line">c3: 25601241268900087228853235319569275926328919786631787991019848828558430219449358810095537362492238844266084660904521793373698736119824512458196492049138821633273765102576368573691391116632126183996786969554104441242376959688329346567745607825277943462236901478944551669406261301309719409165457168678763092118</span><br></pre></td></tr></table></figure><h2 id="解"><a href="#解" class="headerlink" title="解"></a>解</h2><p>首先破解加密脚本，是一个常见的低指数加密广播攻击，e&#x3D;3,可以参考一下如下内容：</p><p><a href="https://blog.csdn.net/qq_46145027/article/details/125047313">https://blog.csdn.net/qq_46145027/article/details/125047313</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">125267411676839013904356880992044234494446196964982422223130579882047339346910691451497681975351838034684254305738613386927222900898672184001345811471784343779083336010063097729870079645284178978512325038316112509718505547104307526489798594871208559607331790920412305711830820739308995357441030646151241475357</span></span><br><span class="line">c1 = <span class="number">53377681151597930200174280269480737905892580547675095951568028531545776989476273786562435486230550919422086944133253611872983670236114054374565938184593173194919064517779661178744278071496565181181705071524501841159717567250259220092464925447795412484629687708208662079791459184303259833667333882817260906165</span></span><br><span class="line">n2 = <span class="number">101985110329687359982214188967281711679876126442294375297547334583432698756724057183438691227371260175904715854057793173086301783390154807726779286131084537704721881438398569476214173211311977143694032174701007005033830070482491565424683664984059187439768982994371382763048098663670188786016786612348042190633</span></span><br><span class="line">c2 = <span class="number">86370003324603283962938004647941072863866893771153362222202759619566185050496089684606274416415418388916028237984708280964054009059814813483639010674182298294505525549842057730933691736372086557397211586739691237738757897947336698446258197604918828646265244195686107866422922575275382813594250335044143485624</span></span><br><span class="line">n3 = <span class="number">83259448903366278561128205003734328779222118906091604625605804813528274055482582431201682767294594942491788720967344243567819654813240542076250030802111361571504667752481579915864184180358691091092122509649590043074189547962292835856503625214027405901620103615424259796442446412031011575671410630232956892267</span></span><br><span class="line">c3 = <span class="number">25601241268900087228853235319569275926328919786631787991019848828558430219449358810095537362492238844266084660904521793373698736119824512458196492049138821633273765102576368573691391116632126183996786969554104441242376959688329346567745607825277943462236901478944551669406261301309719409165457168678763092118</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n = [n1, n2, n3]</span><br><span class="line">c = [c1, c2, c3]</span><br><span class="line">resultant, mod = crt(n, c)</span><br><span class="line">value, is_perfect = gmpy2.iroot(resultant, e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(value))</span><br></pre></td></tr></table></figure><p>结果为一个网址：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b&#x27;This is your destination: &quot;https://pastes.io/1yjswxlvl2&quot;\n&#x27;</span></span><br></pre></td></tr></table></figure><p>在该网页上下载了如下文件：Flag_it_is.txt</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">You</span> think this is <span class="title class_">Gibbrish</span>, but it<span class="string">&#x27;s something different...</span></span><br><span class="line"><span class="string">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oAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigArzP9oXX/wCxPhrfQRvtuNSYWS467W5f/wAdBH416ZXyt+1F4i/tHxla6LA+YNLh/eY6GaTDH8l2D86cVdgzxevr/wDZE8NDTvBd9rkyYuNUn2ox6+VHkD82LH8q+R7CzuNRv7ays0Ml1cyrDEg/idiAB+Zr9G/CGiQ+G/DOmaPbY8qyt0hB/vEDk/icn8aufYKa6mxRRRUGwUUUUARXEEc6bZFyPXuKxbuykg5Hzp6jt9a36QjIoE1c5alrautOjlOY/kb26Gsy4s5oOWTK+q80iGiCiiigkKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKSlpKACiiigAooooAWiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigCC+uorGyuLu5YJBbxNNIx7KoLE/kDXwN4i1WXXNe1DVJyfMvJ3mOe2TkD8BgV9VftJeIDpHw6lsYX23GqyrbcdfLHzP8AmAB/wKvkStILqTI9d/Zg8O/258T7e7kTdb6VEbtiRwG+6n6kn/gNfbo6V4f+yb4ZXSPh9Lq00eLrV5zLuI58lPlQfnvP417hUyd2bQVkFFFFIoKKKKACiiigAxRiiigCtPZQTZLJhvVeKzptMkXmNg49Dwa2qKBNJnLyI0bbXUqfQ0ldNJGrrh1DD3FUZ9MjfmIlD+YpEuJj0VZmsZ4v4dw9V5qt0POaCAooooAKKKKACiiigAooooAKKKKACiiigAooooAKQ0tIaACiiigAooooAWiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiqesahFpWk3uoXLBYLSF53J9FBP8ASgD5Y/aZ8RDVvHq6XA2bfSIhC3oZmwzn8AVX8DXlujadcaxq9lptiu66vJkgiH+0zAD+dJq1/Nquq3moXJzNdTPM592JJ/nXr37Kfh3+1viM2pypug0mAzAnoJHyq/puP4VrsiUryPsDw7pUGh6HYaXaDFvaQJCnHUKMZrRoHSiszoCiiigAooooAKKKKACiiigAooooAKMUUUAGKhntoph+8QE+vepqKAMqfS+8L/g3+NZ00TwvskGDXSOQqknoK5u4lM07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F1GzucTMRmGA8gYByxHrjJ71d8beH7rXbnw1JaSQIumatFfzeaxG6NUkUhcA5bLjrgdeaB3LPiS41HSoWuvD3h5NWvZ2AmVbiO2YgD5SzN19Paub+DDwNo2tEmSLV5dVnudTtJI/LNtcPgmMDJyoULhsndyfYWdR07xppevajd+HLrTtT06+ZZfsmqTSo1q4UKRGyhhsOM7SBg9O9R+GdOufBmn65rviaRr7VdUuluLlNLtpJVTgIkcaAFmAHcj69M0CKvwTvfL8OPoX2a5Y6ZcXEf24Jm1uMzuf3Un8WM4PHBBr0euP+EWnXmlfDvSLXUreS2ugJZXhkGGTfK7gMOxwwyK7CgGFFFFAhKKKKACiiigAooooApaTpdlpMEsOnW6wRSyvO6qTy7nLNz6nmrtFFABRRRQAUUUUAFZ+uaNp2vadJYazZw3lo5BMUq5GR0I9D7jmtCigDl9G8A+GNG1CO+sNJjW8iBEc0sjzNHn+6XY7fwxXUUUUAFFFFABRRRQAVh+IPCmieIrm1n1uwS8e1OYhIzbByDyoO1uQOoPStyigAooooAUUUUZoAKKM0ZoAKKM0ZoAKKM0ZoAKKM0ZoAKKM0UAFFGaM0AFFGaM0AFFGaM0AFFGaM0AFFGaM0AFFGaM0AFFGaM0AFMniSeCSGVd0cilGGcZBGDT80ZoAwvDXhLQ/DLTvomnx20k+BLJuZ3cDoCzEnA9M4rdozRmgAoozRmgAoozRmgAoozRmgAoozRmgAoozRmgBKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/Z</span></span><br></pre></td></tr></table></figure><p>刚开始不是很懂，搞了半天没看明白如何破解，后来询问了一下身边的大佬，说是base64转图片，提供了一个在线工具：</p><p><a href="https://www.lddgo.net/convert/base64-to-image">https://www.lddgo.net/convert/base64-to-image</a></p><p>把上面的文件传入即可得到如下图片：<br><img src="https://pic.imgdb.cn/item/65ec35129f345e8d03542289.jpg" alt="alt text"></p><p>over!</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PearlCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP_2024HSCCTF_CRYPTO_REAL_SIGN_IN</title>
      <link href="/2024/03/09/wp-2024hscctf-crypto-real-sign-in/"/>
      <url>/2024/03/09/wp-2024hscctf-crypto-real-sign-in/</url>
      
        <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;HSCCTF&#123;*************************&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    c = powmod(m, e, n)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n&quot;</span>, i, <span class="string">&quot;=&quot;</span>, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c&quot;</span>, i, <span class="string">&quot;=&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n1 = 13266094979118433615107077438835111371457503704538616496563510289250600197984029767950953071723442381279904747724269706555801425883117040972832035397268347603612025741219452353130266755150965019441092380030226256032720651858600172996344598355816134478110939124633509594465443169697188695226358357129879780253706604232278678465680358018262084198108533077519049507811758423498512565521615931699494491595078723098101084217611204442585182103261006086144344612398896576066999950905966920722348056083426326740287336766359383868804991393096926457607860171709146742941740864780610226463852018204647096292737915760430291250813</span></span><br><span class="line"><span class="string">c1 = 10454892625278317641789872724686322205927252335791803070937784201169059579634108503308033729970364983743915474860354063759051514315619953792921367621385574749886778911471839079815820922430263016140141364094131496885155882486798302404238523986615316359385759537428069831379320707742928167131988641527992674882901567191207763547432299532710945549959580670112346830919500694014972444803904248586178887470465867991650480024904327432717911313867713120525202669101524778826445503383549733326775312427637839488477432162027468606568090607495541492335140760946449358303999218277269859230888292780234275495274787996001069959971</span></span><br><span class="line"><span class="string">n2 = 13561524319281645924409429988746244285924512610515302181526524036825687984904507677894611353344735741110533280540372734178963216876945066232927791369207852762146826883906093804958723203309030840804897999205074456325062789110452940484077408580876939074453733126571662068654441714639301799127584606087971553812926212292460761915985786461807649546286330834719746624387850833859250717790492671884734393055454074719585937904232516659582736211933280011591605069686791049628396762690038333975652490908544846890333889140489210242676577675968427325105786641017561929481335597681693818435892140856959673754213600282444761045909</span></span><br><span class="line"><span class="string">c2 = 3809937396638973793281111150837774607768836561256425490071061814543315217182689579329457784159377040740840790603579270672790822179042079055887400637582022659400594844425891666493759469522229692267103516295923589666151948947533002975509430505778081264268698292606209538047240829756919764958544518311993684790118122163859571923899116815269989298822142104789156965964388346807167061332155392766290531602747731916010774318400533536413925876554324550780136191458776623029231802991319498346243427246484439391940676640693616519788950250194620455331557435567742874072637005171754550020619361150150760807391307377493836703076</span></span><br><span class="line"><span class="string">n3 = 20819967432768567938753694422911303382713641435728476601586838051751312782014589687874100683447016549893853820399247909653519950995166805072380656652093579604808569443345700131756901813968185726839863492859231569896747987531341038527577030274701158504736611486411122416871876820360598851918276248520018793494992493852386399935919098185299268920688465446256283333918993392163947559470887074488117510961172278330026050882249897526926951246915378841961743261451053094912730850754242934166148766977209435597121171360066632973035097557482087715745940551760350028517912402795353929678770383484462337839762404384487582066453</span></span><br><span class="line"><span class="string">c3 = 11563829913521314742585136805475993461403465700108053759771484386843765447294825812595747844564874801821547385942939017711043792590427266240133027831461974927558652665067213878683577605892319949704019193752250409813868906421753286690558646631157080887991363101311595921894128110588310204725909211948500421818595333014728114922612870236792445180757918034580210383348205174677492784034863701447097219480133095005954043490631339361280493810083309703940614371501369647446672052159714963350601039281652141446041256158792981347520865671115091097366786582678000769990989485879756562971825181583852052194492966890258786944315</span></span><br><span class="line"><span class="string">n4 = 19517605474769458566764053169103203900538883167125789442948194023333599294853531273087386563161613748743818343948170765525802041313369094525708034240492038517491037697421019698672940028061489377078569027204940525741751607758706837789276571889269840463242449627036923444536643477208091664006240106337894541529098279162689793633659155131183323675883233214674098857553487390844015483326711766090826364639791072315148015450491509411705543419711632894282105698410629463141048089867016193055384530738113369352506445669521342292860468297676826301170714618519525841753642713267083007541894156522819536935129135488289198694889</span></span><br><span class="line"><span class="string">c4 = 12720867554077215609167247949706745145667570273372296302246080668969511222297653722462456233088262153562301044885409538816931281414687572296907970004441185871229786306419586839050961363065587925188623309437687878362349712010861419409491068481019724226070296781806932012179356550421791040143093709543578156689726256993615533679238619784087615967419616376736870824897695863732260595608905898821074250285903989668303290834003098691902990265526695777899489911426855957844561961729063644070823142386451495647995297413399808476505524581260464059786283824394788336780567702950051743361294131648282343329587709077103035316720</span></span><br><span class="line"><span class="string">n5 = 15315765971812428868126611109300419975777573811870059860288938012581131143314666287089472408729190306740351316922426244732585067377217502116440145450875665683575473308102742095244349804293311006664351646952181210686812748912418175736013835669191549110546127830831456068811493086787520032272004231879188572130659936937680177977058975692716116961651093033986073297040678707534300965722868263825444198679243070507413216087205293997006805636338567585815764233374917745809135568855524993022583535608349280044851332779641619210310837108819273508771161881712796235518243572549756276118053736270122787899173695729089911000177</span></span><br><span class="line"><span class="string">c5 = 1996576325989768324317887012680560370528949194626393664650182754791578697786369958145137743555674312911707989139883926276952465377328602829900403114611234863417183707678398047030046855450074260654432278156903388641948696716193734714839957624359533486844023111115297718398319120718217043728064595217651738180806194912581964346594873253580010279706758241793778842399330631789750327865945625117967957133863637176404309782516880511747771793712203903185512285327103080133567660391921038681393551945607152726063692641742286406772926103324078574181176632321287759066802783643421564667257668981655199672490410258387124896839</span></span><br><span class="line"><span class="string">n6 = 22501623321194869030526666823514739767749207843970334295553523279818676682652976959807729381646792676134988101065783136759904452189288813040860021497429422935571083993146794186207853146483681094375360774768406629588311381375206331368965836725531623084019451921330442379292718421616088275750226791314378297932358311378533569620671423740598033204639634035814689781736104197321348154999759210532651451336192376531975837284751978609197068573278551236896713762616106051882505752287773203197087939983952212761603430314087275042009367400077728025285967811883773835952547025411853395307325959904214255100115763377527761863243</span></span><br><span class="line"><span class="string">c6 = 16972901653690784382193404778525843883847230468707217844241233207197480301434902629018088740822889948972102445668033489181324675531537650785766582307112083721410506834279363487814759021815005839906656731069521758605293428928322712895510490968448490116732590950772037788323801838566829526879837783860631971103738986788475652187080935944428662363573097225322630574705977616143315497272754050608117449938161772409924992453640310621899223691851303921323537779068346575997621024660907750345496836548887894110692437965970524341315015139872598871247336564148953981001708145253728789799483753931039894943324458172207408514055</span></span><br><span class="line"><span class="string">n7 = 20222972180177072345801227937253710431874005900913732040381986459681923475683145372990375296354647420667483866455563976492495863306613645199351725323069254033914660444884681801701527128578914815647228265457580192591405358646605069362025887082090772778349481109768859094222573588734354390770166651349176555216207359309348018342505464249804607873118984688190648392606550835717828160317062604597079101529586592809846608153548090689114431569844519317969076852156023429809918618137153901636552629572816865533796914796916912143735510069871682428043277595493567381686086440480398579063801490541087200975224372047447666853577</span></span><br><span class="line"><span class="string">c7 = 19248329020030453774384696880312801243022181399316695013193573740699955812434234453445733160128408889312090775734047782876100145988183327884917215679382382881065419870764186721970622248713761494850863082727373673264251951250813933154161422645331713437130381414540777017708015790836797014483890216068812718266206449620134392843370036352310247384624064366465809379383305877737001168693796305842850301708205795174536047495356081533121119809621200677554802850741327026857766466801847093397207492834507197621929666294565502206253758771807936447505283097006026148803103761799795917848061959407655084012166916418019312249784</span></span><br><span class="line"><span class="string">n8 = 28799545621025859784610107508239196961299975467825740831913751504915874851330462439158635575405356818113410333683180082332165697120427112955103148744439425445183885200419323900649247390987373643732545351428341672132606990651983217136427779727640093677134233750683573339125630816150512829880758197582740742903567508671599670638441690064624970884849155079924261319378412468315205937959638074779010811695132863607314175199659821450983825173738122749043063821539706648079731459596593171608003970504410762959266052601005965264083020025264976022719772719760327913949451765549596654112776579032915566112007668167772800022899</span></span><br><span class="line"><span class="string">c8 = 1557912453709476966737076991561069916132026563623952214325899450684779611396005511525194425002377424080593548871717093344298154722414402662579348749814362372502553596876087924405512346139642130044966150910684629355033505918013408065432489689359533653824531829749196503353303426506457519870729578421517704788083837871239684468506646791031429111449024396111145925900274462731352865657439734650971847748974665555525054155117163435567228916046859498167502129739768590572170326191362542459346405142436764480239930123323175219488501180973820200030365386979265642090761227134669853119027964377516064450203673169996741108201</span></span><br><span class="line"><span class="string">n9 = 10724722645304259715795299819065674754042984013786210584506231300619560676108475536395272046569973743641251757746061197828519780315618458377103563062231183483417813026164932742828160245936263717653018746001798106670074713826425538758327538077666818411803556790303118703675214570232032363741244652199877829850941356975349610433270602500949664737614829264570720376982697613497917773407899889472415398738368753150300782201701629840263791099898799223939097237737763305744244520913831151361155926462086252389196548583215275230652627205709362921989235487237437830519479308853639024184940767904019468405024567279269194660457</span></span><br><span class="line"><span class="string">c9 = 7054636121132343583858699301095750714111235817920115459468707884725018199621185268565462099537583727231123935665880304441155106987655834264363622503952228720525242179508079016631089564472694196928292967592007090527901832440980478605545275893294775905732209796463597105116676363505607644384293210905609044898854823349412282236466031666385339991490559120640881321780940909164095426401350314009757434019464208207922992311335823038396957805698822367795673327054284423260967631762122524511318733561339982590040303505605155884427567432712042870632816967182611225212150848091424300840160529323960243459920269872536666352976</span></span><br><span class="line"><span class="string">n10 = 16304817901397483417456609341516124523232426780023397228272913044723365389571327797134591736977502692057727416394924310828824378024812777529367342707896494815960255682947685036902235997899886291633609041685897197272675911304941501067794795285949540313990226409651292120126492714998892290044111541098365692731185787360609198921681736777103794430653696698141195954719030883935151980847339939213040373252819145655067286986300641668994700390921458682571619409488233289211738521046085311253119526685912893458131534718050802684180285138809217274273877376347024021056317566312186133916744533463879779997794540361760393219489</span></span><br><span class="line"><span class="string">c10 = 6039122660803656157700054739064564338439549484695206214016006129508782362229842967602464077735874540107161459041835340990108817139672137870642935613531313583963930144871458733026396223674801557621036949312116639217447114899726858984281194116508244403985568785765273838572470898925521147022021516862658967584135454474355381073026066426450614788381002057980590442338766869104957577338546687759141228942149374485785893539335288536729328218172278370763183603422629799846611737710865681572257803448960656692506773086527389616178693152885260795303008111935277529561576915114165678564997923634906377059491989399467738069641</span></span><br><span class="line"><span class="string">n11 = 26625591570108917991847624024325819020320989255483608230644879476517915211995542896341416515605576928392317717654695767006784744751962205355107012859426134474074616134986414248054781712130892076462288761672616993287474215271046602443215449210026303978249752825306035097841429567784265656890801589418315449927543660131967365276637662563112328427813183398517944210120851841495001293543971765864382060100600179108814852829473884481867272716907064729991187798328733196676298681328399250356028155411865948758466337763025886685436650643428510593697176416735568250615673642866668416526682341721998481502482877972649018501469</span></span><br><span class="line"><span class="string">c11 = 20247005397625616228661928392695469647749434533141783786437968083066137357689767280753532605896419173332597529708801946906363780592876111104850302784033136335456683361128603662454728234349563238948801712907903185993561076754164552845510795293521029798357876214260903355702688269527465118808832941386890598851762900876512383557653940846232884627557957652638581022140825373023173482471791720148792301241581919765510220083079365311297081633979398855966991069020584462613981094888736916444009463104235004451765533162593406749138640537670707679905027165914805299755934758172748227146495107002603546338597452964759860431081</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="解"><a href="#解" class="headerlink" title="解"></a>解</h2><p>这是一个公因数攻击(多组n和c)  因为有多个n和c，所以可能会存在两个n之间存在大于1的公因数，以此破解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 公因数攻击(多组n和c)</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">13266094979118433615107077438835111371457503704538616496563510289250600197984029767950953071723442381279904747724269706555801425883117040972832035397268347603612025741219452353130266755150965019441092380030226256032720651858600172996344598355816134478110939124633509594465443169697188695226358357129879780253706604232278678465680358018262084198108533077519049507811758423498512565521615931699494491595078723098101084217611204442585182103261006086144344612398896576066999950905966920722348056083426326740287336766359383868804991393096926457607860171709146742941740864780610226463852018204647096292737915760430291250813</span></span><br><span class="line">c1 = <span class="number">10454892625278317641789872724686322205927252335791803070937784201169059579634108503308033729970364983743915474860354063759051514315619953792921367621385574749886778911471839079815820922430263016140141364094131496885155882486798302404238523986615316359385759537428069831379320707742928167131988641527992674882901567191207763547432299532710945549959580670112346830919500694014972444803904248586178887470465867991650480024904327432717911313867713120525202669101524778826445503383549733326775312427637839488477432162027468606568090607495541492335140760946449358303999218277269859230888292780234275495274787996001069959971</span></span><br><span class="line">n2 = <span class="number">13561524319281645924409429988746244285924512610515302181526524036825687984904507677894611353344735741110533280540372734178963216876945066232927791369207852762146826883906093804958723203309030840804897999205074456325062789110452940484077408580876939074453733126571662068654441714639301799127584606087971553812926212292460761915985786461807649546286330834719746624387850833859250717790492671884734393055454074719585937904232516659582736211933280011591605069686791049628396762690038333975652490908544846890333889140489210242676577675968427325105786641017561929481335597681693818435892140856959673754213600282444761045909</span></span><br><span class="line">c2 = <span class="number">3809937396638973793281111150837774607768836561256425490071061814543315217182689579329457784159377040740840790603579270672790822179042079055887400637582022659400594844425891666493759469522229692267103516295923589666151948947533002975509430505778081264268698292606209538047240829756919764958544518311993684790118122163859571923899116815269989298822142104789156965964388346807167061332155392766290531602747731916010774318400533536413925876554324550780136191458776623029231802991319498346243427246484439391940676640693616519788950250194620455331557435567742874072637005171754550020619361150150760807391307377493836703076</span></span><br><span class="line">n3 = <span class="number">20819967432768567938753694422911303382713641435728476601586838051751312782014589687874100683447016549893853820399247909653519950995166805072380656652093579604808569443345700131756901813968185726839863492859231569896747987531341038527577030274701158504736611486411122416871876820360598851918276248520018793494992493852386399935919098185299268920688465446256283333918993392163947559470887074488117510961172278330026050882249897526926951246915378841961743261451053094912730850754242934166148766977209435597121171360066632973035097557482087715745940551760350028517912402795353929678770383484462337839762404384487582066453</span></span><br><span class="line">c3 = <span class="number">11563829913521314742585136805475993461403465700108053759771484386843765447294825812595747844564874801821547385942939017711043792590427266240133027831461974927558652665067213878683577605892319949704019193752250409813868906421753286690558646631157080887991363101311595921894128110588310204725909211948500421818595333014728114922612870236792445180757918034580210383348205174677492784034863701447097219480133095005954043490631339361280493810083309703940614371501369647446672052159714963350601039281652141446041256158792981347520865671115091097366786582678000769990989485879756562971825181583852052194492966890258786944315</span></span><br><span class="line">n4 = <span class="number">19517605474769458566764053169103203900538883167125789442948194023333599294853531273087386563161613748743818343948170765525802041313369094525708034240492038517491037697421019698672940028061489377078569027204940525741751607758706837789276571889269840463242449627036923444536643477208091664006240106337894541529098279162689793633659155131183323675883233214674098857553487390844015483326711766090826364639791072315148015450491509411705543419711632894282105698410629463141048089867016193055384530738113369352506445669521342292860468297676826301170714618519525841753642713267083007541894156522819536935129135488289198694889</span></span><br><span class="line">c4 = <span class="number">12720867554077215609167247949706745145667570273372296302246080668969511222297653722462456233088262153562301044885409538816931281414687572296907970004441185871229786306419586839050961363065587925188623309437687878362349712010861419409491068481019724226070296781806932012179356550421791040143093709543578156689726256993615533679238619784087615967419616376736870824897695863732260595608905898821074250285903989668303290834003098691902990265526695777899489911426855957844561961729063644070823142386451495647995297413399808476505524581260464059786283824394788336780567702950051743361294131648282343329587709077103035316720</span></span><br><span class="line">n5 = <span class="number">15315765971812428868126611109300419975777573811870059860288938012581131143314666287089472408729190306740351316922426244732585067377217502116440145450875665683575473308102742095244349804293311006664351646952181210686812748912418175736013835669191549110546127830831456068811493086787520032272004231879188572130659936937680177977058975692716116961651093033986073297040678707534300965722868263825444198679243070507413216087205293997006805636338567585815764233374917745809135568855524993022583535608349280044851332779641619210310837108819273508771161881712796235518243572549756276118053736270122787899173695729089911000177</span></span><br><span class="line">c5 = <span class="number">1996576325989768324317887012680560370528949194626393664650182754791578697786369958145137743555674312911707989139883926276952465377328602829900403114611234863417183707678398047030046855450074260654432278156903388641948696716193734714839957624359533486844023111115297718398319120718217043728064595217651738180806194912581964346594873253580010279706758241793778842399330631789750327865945625117967957133863637176404309782516880511747771793712203903185512285327103080133567660391921038681393551945607152726063692641742286406772926103324078574181176632321287759066802783643421564667257668981655199672490410258387124896839</span></span><br><span class="line">n6 = <span class="number">22501623321194869030526666823514739767749207843970334295553523279818676682652976959807729381646792676134988101065783136759904452189288813040860021497429422935571083993146794186207853146483681094375360774768406629588311381375206331368965836725531623084019451921330442379292718421616088275750226791314378297932358311378533569620671423740598033204639634035814689781736104197321348154999759210532651451336192376531975837284751978609197068573278551236896713762616106051882505752287773203197087939983952212761603430314087275042009367400077728025285967811883773835952547025411853395307325959904214255100115763377527761863243</span></span><br><span class="line">c6 = <span class="number">16972901653690784382193404778525843883847230468707217844241233207197480301434902629018088740822889948972102445668033489181324675531537650785766582307112083721410506834279363487814759021815005839906656731069521758605293428928322712895510490968448490116732590950772037788323801838566829526879837783860631971103738986788475652187080935944428662363573097225322630574705977616143315497272754050608117449938161772409924992453640310621899223691851303921323537779068346575997621024660907750345496836548887894110692437965970524341315015139872598871247336564148953981001708145253728789799483753931039894943324458172207408514055</span></span><br><span class="line">n7 = <span class="number">20222972180177072345801227937253710431874005900913732040381986459681923475683145372990375296354647420667483866455563976492495863306613645199351725323069254033914660444884681801701527128578914815647228265457580192591405358646605069362025887082090772778349481109768859094222573588734354390770166651349176555216207359309348018342505464249804607873118984688190648392606550835717828160317062604597079101529586592809846608153548090689114431569844519317969076852156023429809918618137153901636552629572816865533796914796916912143735510069871682428043277595493567381686086440480398579063801490541087200975224372047447666853577</span></span><br><span class="line">c7 = <span class="number">19248329020030453774384696880312801243022181399316695013193573740699955812434234453445733160128408889312090775734047782876100145988183327884917215679382382881065419870764186721970622248713761494850863082727373673264251951250813933154161422645331713437130381414540777017708015790836797014483890216068812718266206449620134392843370036352310247384624064366465809379383305877737001168693796305842850301708205795174536047495356081533121119809621200677554802850741327026857766466801847093397207492834507197621929666294565502206253758771807936447505283097006026148803103761799795917848061959407655084012166916418019312249784</span></span><br><span class="line">n8 = <span class="number">28799545621025859784610107508239196961299975467825740831913751504915874851330462439158635575405356818113410333683180082332165697120427112955103148744439425445183885200419323900649247390987373643732545351428341672132606990651983217136427779727640093677134233750683573339125630816150512829880758197582740742903567508671599670638441690064624970884849155079924261319378412468315205937959638074779010811695132863607314175199659821450983825173738122749043063821539706648079731459596593171608003970504410762959266052601005965264083020025264976022719772719760327913949451765549596654112776579032915566112007668167772800022899</span></span><br><span class="line">c8 = <span class="number">1557912453709476966737076991561069916132026563623952214325899450684779611396005511525194425002377424080593548871717093344298154722414402662579348749814362372502553596876087924405512346139642130044966150910684629355033505918013408065432489689359533653824531829749196503353303426506457519870729578421517704788083837871239684468506646791031429111449024396111145925900274462731352865657439734650971847748974665555525054155117163435567228916046859498167502129739768590572170326191362542459346405142436764480239930123323175219488501180973820200030365386979265642090761227134669853119027964377516064450203673169996741108201</span></span><br><span class="line">n9 = <span class="number">10724722645304259715795299819065674754042984013786210584506231300619560676108475536395272046569973743641251757746061197828519780315618458377103563062231183483417813026164932742828160245936263717653018746001798106670074713826425538758327538077666818411803556790303118703675214570232032363741244652199877829850941356975349610433270602500949664737614829264570720376982697613497917773407899889472415398738368753150300782201701629840263791099898799223939097237737763305744244520913831151361155926462086252389196548583215275230652627205709362921989235487237437830519479308853639024184940767904019468405024567279269194660457</span></span><br><span class="line">c9 = <span class="number">7054636121132343583858699301095750714111235817920115459468707884725018199621185268565462099537583727231123935665880304441155106987655834264363622503952228720525242179508079016631089564472694196928292967592007090527901832440980478605545275893294775905732209796463597105116676363505607644384293210905609044898854823349412282236466031666385339991490559120640881321780940909164095426401350314009757434019464208207922992311335823038396957805698822367795673327054284423260967631762122524511318733561339982590040303505605155884427567432712042870632816967182611225212150848091424300840160529323960243459920269872536666352976</span></span><br><span class="line">n10 = <span class="number">16304817901397483417456609341516124523232426780023397228272913044723365389571327797134591736977502692057727416394924310828824378024812777529367342707896494815960255682947685036902235997899886291633609041685897197272675911304941501067794795285949540313990226409651292120126492714998892290044111541098365692731185787360609198921681736777103794430653696698141195954719030883935151980847339939213040373252819145655067286986300641668994700390921458682571619409488233289211738521046085311253119526685912893458131534718050802684180285138809217274273877376347024021056317566312186133916744533463879779997794540361760393219489</span></span><br><span class="line">c10 = <span class="number">6039122660803656157700054739064564338439549484695206214016006129508782362229842967602464077735874540107161459041835340990108817139672137870642935613531313583963930144871458733026396223674801557621036949312116639217447114899726858984281194116508244403985568785765273838572470898925521147022021516862658967584135454474355381073026066426450614788381002057980590442338766869104957577338546687759141228942149374485785893539335288536729328218172278370763183603422629799846611737710865681572257803448960656692506773086527389616178693152885260795303008111935277529561576915114165678564997923634906377059491989399467738069641</span></span><br><span class="line">n11 = <span class="number">26625591570108917991847624024325819020320989255483608230644879476517915211995542896341416515605576928392317717654695767006784744751962205355107012859426134474074616134986414248054781712130892076462288761672616993287474215271046602443215449210026303978249752825306035097841429567784265656890801589418315449927543660131967365276637662563112328427813183398517944210120851841495001293543971765864382060100600179108814852829473884481867272716907064729991187798328733196676298681328399250356028155411865948758466337763025886685436650643428510593697176416735568250615673642866668416526682341721998481502482877972649018501469</span></span><br><span class="line">c11 = <span class="number">20247005397625616228661928392695469647749434533141783786437968083066137357689767280753532605896419173332597529708801946906363780592876111104850302784033136335456683361128603662454728234349563238948801712907903185993561076754164552845510795293521029798357876214260903355702688269527465118808832941386890598851762900876512383557653940846232884627557957652638581022140825373023173482471791720148792301241581919765510220083079365311297081633979398855966991069020584462613981094888736916444009463104235004451765533162593406749138640537670707679905027165914805299755934758172748227146495107002603546338597452964759860431081</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = []</span><br><span class="line">c = []</span><br><span class="line">p = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    n.append(<span class="built_in">eval</span>(<span class="string">&#x27;n&#x27;</span> + <span class="built_in">str</span>(i)))</span><br><span class="line">    c.append(<span class="built_in">eval</span>(<span class="string">&#x27;c&#x27;</span> + <span class="built_in">str</span>(i)))</span><br><span class="line">data = <span class="built_in">list</span>(<span class="built_in">zip</span>(n, c))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(n)):</span><br><span class="line">        <span class="keyword">if</span> gmpy2.gcd(n[i], n[j]) != <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(i, j)    <span class="comment"># i=4,j=5</span></span><br><span class="line">            <span class="built_in">print</span>(gmpy2.gcd(n[i], n[j]))</span><br><span class="line">p = gmpy2.gcd(n5, n6)</span><br><span class="line">q = n5 // p</span><br><span class="line">d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">m = <span class="built_in">pow</span>(c5, d, n5)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>over！</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HSCCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP_2024HSCCTF_CRYPTO_FUNNY</title>
      <link href="/2024/03/09/wp-2024hscctf-crypto-funny/"/>
      <url>/2024/03/09/wp-2024hscctf-crypto-funny/</url>
      
        <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from <span class="title class_">Crypto</span>.<span class="title class_">Util</span>.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">1627858721743596752497831640628357323459243890844363792736407789751577427319257708507686114456632938183775129585728892845205290864750578798354859933996208521450129131173352490118085939969385911306718129785035108056909135931322755908602656567223998858450130768625587559935064753603718657989533793373124922891077849376447589198239126291127263234784363556777780461489387706699053671315621968807065360907667815336609878856798387057891974730460404647229308105442629038061284060276648993434681114539955086828451085582033288860959729755856478065093327544217813990665326820156340461326538271909605715822484950196033809892232121330623027855970475888202583512234213349462680452400729903400494519431590431864717223438807093669836615356855072370571595889807712166659061190031457954071146645411277702230847389264989391715763232453605404095019402186331633202953693057641475300619482863265936513394341066776619336452923951439714749067348507</span></span><br><span class="line">q = <span class="number">165059760196977338034268528857897083190717585647808271832795575354736221674892279730906525407442580833042731114617534865267230347093979480666213073939602212663043286794259410177026619955285626139270678815060566416554620185859901611571955490060241822054715533030464833509114500388615748465579240918292431860839</span></span><br><span class="line">c = <span class="number">209347444484196477254668267578954904181293909211985372842733666165076889646025992007884927283300662833989678431462547742385291078285045060028956748455410812196305788814280968487973559115983082461315009316488143477261307107939530267533197821947240438534411830018967506368459544025037634267899970815198992392565948727381322854560823769432552779881938316107779842525092269591932257206582810678457433166038809740255591841951300818106018061065936083887559841543250701094558114335651396741896281230175124133873529005816838785880680073159461666783649744640398010841282229366323100807220116460976549981263966530038289223576133865992894885483308732021144420507955669760623032114718333853671281281221009397028372653797668774820725717817362383394165014402977767667433542733963298092312930702496796235196487999167666133884266829605503363510544384236303968829214389757297563873395131798724306227675722494797069994655456021649231626359765579028950908065367760981736933167557841586896807116262630848742514005606289980676609588756946993271763119859088002784499062149533167332388600036550273743940503131248513795389688869470432261503038708892320267815658450917855334244502333938120781251564676408212996623419957317150267768978807968208353379334556945</span></span><br><span class="line"></span><br><span class="line">d = inverse(<span class="number">65537</span>, q - <span class="number">1</span>)</span><br><span class="line">m = powmod(c, d, q)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h2 id="解"><a href="#解" class="headerlink" title="解"></a>解</h2><p>直接运行就行</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HSCCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python中stylecloud包的使用</title>
      <link href="/2024/03/07/python-zhong-stylecloud-bao-de-shi-yong/"/>
      <url>/2024/03/07/python-zhong-stylecloud-bao-de-shi-yong/</url>
      
        <content type="html"><![CDATA[<h2 id="stylecloud介绍"><a href="#stylecloud介绍" class="headerlink" title="stylecloud介绍"></a>stylecloud介绍</h2><p>stylecloud是一款比较好用的python包，常用于数据可视化操作，具体的介绍看看别人写的吧</p><p><a href="https://mp.weixin.qq.com/s/B23uDxzLUa_45uDh2R9Vlw">https://mp.weixin.qq.com/s/B23uDxzLUa_45uDh2R9Vlw</a></p><p><a href="https://cloud.tencent.com/developer/article/1699651">https://cloud.tencent.com/developer/article/1699651</a></p><p>蒙版图片参考网址：<a href="https://fontawesome.com/license/free">https://fontawesome.com/license/free</a></p><p>中文版：<a href="https://fa5.dashgame.com/#/%E5%9B%BE%E6%A0%87">https://fa5.dashgame.com/#/%E5%9B%BE%E6%A0%87</a></p><p>配色：palettable： <a href="https://jiffyclub.github.io/palettable/">https://jiffyclub.github.io/palettable/</a></p><p>特别需要注意的是蒙版图片的调用：<br>例如：fa-grin-beam，在python中调用好像得改为fa.grin-beam才行，有时候都不行，还是得自己多试试，搞不懂。</p><p>下面是个实例：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">from stylecloud import gen_stylecloud</span><br><span class="line">import jieba</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取数据</span></span><br><span class="line">with open(<span class="string">&#x27;xxxx.txt&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) as <span class="symbol">f:</span></span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文本预处理  去除一些无用的字符   只提取出中文出来</span></span><br><span class="line">new_data = re.findall(<span class="string">&#x27;[\u4e00-\u9fa5]+&#x27;</span>, data, re.S)</span><br><span class="line">new_data = <span class="string">&quot;/&quot;</span>.join(new_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文本分词</span></span><br><span class="line">seg_list_exact = jieba.cut(new_data, cut_all=<span class="title class_">True</span>)</span><br><span class="line"></span><br><span class="line">result_list = []</span><br><span class="line">with open(<span class="string">&#x27;stopword.txt&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) as <span class="symbol">f:</span></span><br><span class="line">    con = f.readlines()</span><br><span class="line">    stop_words = set()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="symbol">con:</span></span><br><span class="line">        i = i.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)   <span class="comment"># 去掉读取每一行数据的\n</span></span><br><span class="line">        stop_words.add(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> <span class="symbol">seg_list_exact:</span></span><br><span class="line">    <span class="comment"># 设置停用词</span></span><br><span class="line">    <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> stop_words <span class="keyword">and</span> len(word) &gt; <span class="number">1</span>:</span><br><span class="line">        result_list.append(word)</span><br><span class="line">print(result_list)</span><br><span class="line"></span><br><span class="line">gen_stylecloud(</span><br><span class="line">    text=<span class="string">&#x27; &#x27;</span>.join(result_list),                   <span class="comment"># 文本数据</span></span><br><span class="line">    size=<span class="number">600</span>,                                     <span class="comment"># 词云图大小</span></span><br><span class="line">    font_path=r<span class="string">&#x27;‪C:\Windows\Fonts\msyh.ttc&#x27;</span>, <span class="comment"># 中文词云  显示需要设置字体</span></span><br><span class="line">    output_name=<span class="string">&#x27;词云12.png&#x27;</span>,                       <span class="comment"># 输出词云图名称</span></span><br><span class="line">    icon_name=<span class="string">&#x27;fas fa.grin-beam&#x27;</span>,                   <span class="comment"># 图标   图片选择网址：https://fontawesome.com/license/free   # https://fontawesome.dashgame.com/</span></span><br><span class="line">    <span class="comment"># palette=&quot;Dark2_7&quot;  # 可以选择不同的配色方案，网址：palettable https://jiffyclub.github.io/palettable/</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>python报错集合</title>
      <link href="/2024/03/07/python-bao-cuo-ji-he/"/>
      <url>/2024/03/07/python-bao-cuo-ji-he/</url>
      
        <content type="html"><![CDATA[<p>1、</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">word_freq = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> <span class="symbol">words:</span></span><br><span class="line">    <span class="keyword">if</span> word <span class="keyword">in</span> <span class="symbol">word_freq:</span></span><br><span class="line">        word_freq[word] += <span class="number">1</span></span><br><span class="line">    <span class="symbol">else:</span></span><br><span class="line">        word_freq[word] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(word_freq):</span><br><span class="line">    print(word)</span><br><span class="line">    print(word_freq[word])</span><br><span class="line"></span><br><span class="line"><span class="title class_">TypeError</span>: <span class="string">&#x27;dict&#x27;</span> object cannot be interpreted as an integer</span><br><span class="line">类型错误<span class="symbol">:<span class="string">&#x27;dict&#x27;</span></span>对象不能被解释为整数</span><br></pre></td></tr></table></figure><p>在打印字典的键值对时出现上述错误，首先是word没有参与循环，其次range(word_freq)使用错误</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">word_freq = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> <span class="symbol">words:</span></span><br><span class="line">    <span class="keyword">if</span> word <span class="keyword">in</span> <span class="symbol">word_freq:</span></span><br><span class="line">        word_freq[word] += <span class="number">1</span></span><br><span class="line">    <span class="symbol">else:</span></span><br><span class="line">        word_freq[word] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> word, freq <span class="keyword">in</span> word_freq.items():</span><br><span class="line">    print(word,word_freq[word])</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 报错集合 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP_2021SWPUCTF新生赛_CRYPTO_traditional</title>
      <link href="/2024/03/04/wp-2021swpuctf-xin-sheng-sai-crypto-traditional/"/>
      <url>/2024/03/04/wp-2021swpuctf-xin-sheng-sai-crypto-traditional/</url>
      
        <content type="html"><![CDATA[<h2 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h2><p>西方的二进制数学的发明者莱布尼茨，从中国的八卦图当中受到启发，演绎并推论出了数学矩<br>阵，<br>最后创造的二进制数学。二进制数学的诞生为计算机的发明奠定了理论基础。而计算机现在改<br>变<br>了我们整个世界，改变了我们生活，而他的源头却是来自于八卦图。现在，给你一组由八卦图<br>方位<br>组成的密文，你能破解出其中的含义吗？<br> 震坤艮 震艮震 坤巽坤 坤巽震 震巽兑 震艮震 震离艮 震离艮<br> 格式：NSSCTF{}</p><h2 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h2><p> 根据文中提到的信息，我们尝试找到了一个图解来展示二进制和中国八卦之间的关系<br><img src="https://pic.imgdb.cn/item/65e7f3549f345e8d03a152f9.jpg" alt="alt text"><br>结合八卦与二叉树之间的的关系，将密文转化为：</p><p>100000001 100001100 000011000 000011100 100011110 100001100 100101001 100101001</p><p>再转为ASCII码</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="string">&quot;001000100 001100001 000110000 000110001 001110011 001100001 001101100 001101100&quot;</span></span><br><span class="line">m = m.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(m)):</span><br><span class="line">    print(chr(int(m[i], <span class="number">2</span>)), <span class="keyword">end</span>=<span class="string">&#x27; &#x27;</span>)</span><br></pre></td></tr></table></figure><p>但是结果发现为乱码<br><img src="https://pic.imgdb.cn/item/65e7f38c9f345e8d03a1fbbf.jpg" alt="alt text"></p><p>按理说不应该啊，怀疑是不是图片给错了，找了好几张类似的，发现图片没错，那就是题目的问题了，尝试了一下把最高位和最低位反着来读</p><p>001000100 001100001 000110000 000110001 001110011 001100001 001101100 001101100</p><p>这样就可以了。。。<br><img src="https://pic.imgdb.cn/item/65e7f39a9f345e8d03a229cb.jpg" alt="alt text"><br>严重怀疑这题是不是出题人搞错了，因为二叉树的下面是高位，上面是低位</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 古典密码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>维纳攻击总结</title>
      <link href="/2024/02/11/wei-na-gong-ji-zong-jie/"/>
      <url>/2024/02/11/wei-na-gong-ji-zong-jie/</url>
      
        <content type="html"><![CDATA[<h2 id="维纳攻击"><a href="#维纳攻击" class="headerlink" title="维纳攻击"></a>维纳攻击</h2><p>wiener attack 是依靠连分数进行的攻击方式，适用于非常接近某一值（比如1）时，求一个比例关系(通常是e &#x2F; N &#x3D; 1)，在不同的题目中也会产生很多变式。</p><h3 id="解题模板"><a href="#解题模板" class="headerlink" title="解题模板"></a>解题模板</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算连分数</span></span><br><span class="line"><span class="string">    :param x: 分子</span></span><br><span class="line"><span class="string">    :param y: 分母</span></span><br><span class="line"><span class="string">    :return: 连分数列表</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算传入列表最后的渐进分数</span></span><br><span class="line"><span class="string">    :param cf: 连分数列表</span></span><br><span class="line"><span class="string">    :return: 该列表最后的渐近分数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cf[::-<span class="number">1</span>]:</span><br><span class="line">        <span class="comment"># 这里的渐进分数分子分母要分开</span></span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> numerator, denominator</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pq</span>(<span class="params">a, b, c</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;使用韦达定理解出pq，x^2−(p+q)∗x+pq=0</span></span><br><span class="line"><span class="string">    :param a:x^2的系数</span></span><br><span class="line"><span class="string">    :param b:x的系数</span></span><br><span class="line"><span class="string">    :param c:pq</span></span><br><span class="line"><span class="string">    :return:p，q</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    par = gmpy2.isqrt(b * b - <span class="number">4</span> * a * c)</span><br><span class="line">    <span class="keyword">return</span> (-b + par) // (<span class="number">2</span> * a), (-b - par) // (<span class="number">2</span> * a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getGradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算列表所有的渐近分数</span></span><br><span class="line"><span class="string">    :param cf: 连分数列表</span></span><br><span class="line"><span class="string">    :return: 该列表所有的渐近分数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    gf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(cf) + <span class="number">1</span>):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    <span class="keyword">return</span> gf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param e:</span></span><br><span class="line"><span class="string">    :param n:</span></span><br><span class="line"><span class="string">    :return: 私钥d</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    <span class="keyword">for</span> d, k <span class="keyword">in</span> gf:</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        p, q = solve_pq(<span class="number">1</span>, n - phi + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">n = <span class="number">639662333905190724963174274393118134850652056724765488685973275138948202602626008285649108873241886836533441901790252560580886492518792249844707754890068885294414947775869189660933854702732140888525369256213185908742658834741758334492843871934294115437721034834635565406377520933839418094457376057043593848401</span></span><br><span class="line">e = <span class="number">548564175098067125961375319851171259385596271876637657761522885808657855394647972481844447376596437557651275057610120865395646169671221375251081541213042646978655686531005856899936162320404991331623237305862913250487293880446994470841390688087392282045130633013139311548859962245908782253213294049851175315059</span></span><br><span class="line">c = <span class="number">266367266471585923035346980467315672043839080179258966276144775106482166900911004389808367589961536843898187180012055918063504477273067284037318171833017082239907978935274619109926579983150571298634653886980563681026116724117473808890951091279814434050754571460308728024448607359710055618866766919226511213734</span></span><br><span class="line"></span><br><span class="line">d=wienerAttack(e, n)</span><br><span class="line">m=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m).decode())</span><br></pre></td></tr></table></figure><h3 id="例题一-HGAME-2022-week3-RSA-attack-3"><a href="#例题一-HGAME-2022-week3-RSA-attack-3" class="headerlink" title="例题一 [HGAME 2022 week3]RSA attack 3"></a>例题一 [HGAME 2022 week3]RSA attack 3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line">n = p * q</span><br><span class="line">d = getPrime(<span class="number">64</span>)</span><br><span class="line">e = invert(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">pow</span>(s2n(flag), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759</span></span><br><span class="line">e = <span class="number">77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095</span></span><br><span class="line">c = <span class="number">165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224</span></span><br></pre></td></tr></table></figure><p>比较常规的 RSA 题型，但问题是e相当的大，甚至与n相当的接近（差了一位数）</p><p>因此我们可以通过 </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n = p * q</span><br><span class="line">d = gmpy2.invert(e, （p-<span class="number">1</span>)*(q-<span class="number">1</span>)）     </span><br></pre></td></tr></table></figure><p>推出 d 非常的小,对此通常采取 维纳攻击 的方法来求取 d (需要知道 e,n)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cf[::-<span class="number">1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> numerator, denominator</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pq</span>(<span class="params">a, b, c</span>):</span><br><span class="line">    par = gmpy2.isqrt(b * b - <span class="number">4</span> * a * c)</span><br><span class="line">    <span class="keyword">return</span> (-b + par) // (<span class="number">2</span> * a), (-b - par) // (<span class="number">2</span> * a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getGradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    gf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(cf) + <span class="number">1</span>):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    <span class="keyword">return</span> gf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    <span class="keyword">for</span> d, k <span class="keyword">in</span> gf:</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        p, q = solve_pq(<span class="number">1</span>, n - phi + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">n= <span class="number">507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759</span></span><br><span class="line">e= <span class="number">77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095</span></span><br><span class="line">c= <span class="number">165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224</span></span><br><span class="line"></span><br><span class="line">d=wienerAttack(e, n)</span><br><span class="line">m=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m).decode())</span><br><span class="line"><span class="comment"># hgame&#123;dO|YOU:kNOw!tHE*PRINcIplE*bEhInd%WInNEr#aTTacK&#125;</span></span><br></pre></td></tr></table></figure><h3 id="例题二-羊城杯-2020-RRRRRRRSA"><a href="#例题二-羊城杯-2020-RRRRRRRSA" class="headerlink" title="例题二 [羊城杯 2020]RRRRRRRSA"></a>例题二 [羊城杯 2020]RRRRRRRSA</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;GWHT&#123;************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">flag1 = flag[:<span class="number">19</span>].encode()  <span class="comment">#两截flag</span></span><br><span class="line">flag2 = flag[<span class="number">19</span>:].encode()</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">P1 = getPrime(<span class="number">1038</span>)</span><br><span class="line">P2 = sympy.nextprime(P1)  <span class="comment">#p2&gt;p1</span></span><br><span class="line"><span class="keyword">assert</span>(P2 - P1 &lt; <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">Q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">Q2 = sympy.nextprime(Q1)  <span class="comment">#q2&gt;q1</span></span><br><span class="line"></span><br><span class="line">N1 = P1 * P1 * Q1</span><br><span class="line">N2 = P2 * P2 * Q2</span><br><span class="line"></span><br><span class="line">E1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">E2 = sympy.nextprime(E1)</span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag1)</span><br><span class="line">m2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, E1, N1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, E2, N2)</span><br><span class="line"></span><br><span class="line">output = <span class="built_in">open</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N1=&#x27;</span> + <span class="built_in">str</span>(N1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;c1=&#x27;</span> + <span class="built_in">str</span>(c1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;E1=&#x27;</span> + <span class="built_in">str</span>(E1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N2=&#x27;</span> + <span class="built_in">str</span>(N2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;c2=&#x27;</span> + <span class="built_in">str</span>(c2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;E2=&#x27;</span> + <span class="built_in">str</span>(E2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.close()</span><br><span class="line"></span><br><span class="line">N1=<span class="number">60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868190554644983911078936369464590301246394586190666760362763580192139772729890492729488892169933099057105842090125200369295070365451134781912223048179092058016446222199742919885472867511334714233086339832790286482634562102936600597781342756061479024744312357407750731307860842457299116947352106025529309727703385914891200109853084742321655388368371397596144557614128458065859276522963419738435137978069417053712567764148183279165963454266011754149684758060746773409666706463583389316772088889398359242197165140562147489286818190852679930372669254697353483887004105934649944725189954685412228899457155711301864163839538810653626724347</span></span><br><span class="line">c1=<span class="number">55094296873556883585060020895253176070835143350249581136609315815308788255684072804968957510292559743192424646169207794748893753882418256401223641287546922358162629295622258913168323493447075410872354874300793298956869374606043622559405978242734950156459436487837698668489891733875650048466360950142617732135781244969524095348835624828008115829566644654403962285001724209210887446203934276651265377137788183939798543755386888532680013170540716736656670269251318800501517579803401154996881233025210176293554542024052540093890387437964747460765498713092018160196637928204190194154199389276666685436565665236397481709703644555328705818892269499380797044554054118656321389474821224725533693520856047736578402581854165941599254178019515615183102894716647680969742744705218868455450832</span></span><br><span class="line">E1=<span class="number">125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820423103</span></span><br><span class="line">N2=<span class="number">60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868195633647431732875392121458684331843306730889424418620069322578265236351407591029338519809538995249896905137642342435659572917714183543305243715664380787797562011006398730320980994747939791561885622949912698246701769321430325902912003041678774440704056597862093530981040696872522868921139041247362592257285423948870944137019745161211585845927019259709501237550818918272189606436413992759328318871765171844153527424347985462767028135376552302463861324408178183842139330244906606776359050482977256728910278687996106152971028878653123533559760167711270265171441623056873903669918694259043580017081671349232051870716493557434517579121</span></span><br><span class="line">c2=<span class="number">39328446140156257571484184713861319722905864197556720730852773059147902283123252767651430278357950872626778348596897711320942449693270603776870301102881405303651558719085454281142395652056217241751656631812580544180434349840236919765433122389116860827593711593732385562328255759509355298662361508611531972386995239908513273236239858854586845849686865360780290350287139092143587037396801704351692736985955152935601987758859759421886670907735120137698039900161327397951758852875291442188850946273771733011504922325622240838288097946309825051094566685479503461938502373520983684296658971700922069426788236476575236189040102848418547634290214175167767431475003216056701094275899211419979340802711684989710130215926526387138538819531199810841475218142606691152928236362534181622201347</span></span><br><span class="line">E2=<span class="number">125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820425393</span></span><br></pre></td></tr></table></figure><p>首先 发现 e 的数值比较大，按照前一题的思路尝试分别对两段加密使用 维纳攻击 发现报错 </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    par = gmpy2.isqrt(b * b - <span class="number">4</span> * a * c)</span><br><span class="line">ValueError: isqrt() of negative number</span><br></pre></td></tr></table></figure><p>产生的原因可能是 E&#x2F;N 远小于 1，并不满足 E 和 N 比较接近这一前提条件</p><p>但是我们发现 N1 和 N2 之间的数值比较接近，符合维纳攻击的前提条件</p><p>为什么使用 N1 和 N2 进行维纳攻击也可以实现解呢</p><p>我们可以通过下面的公式推导得出</p><p><img src="https://pic.imgdb.cn/item/65eecd579f345e8d035b6589.png" alt="alt text"></p><p>挖个坑：需要了解的内容有： 连分数、低解密指数攻击 等</p><p>有如下解码脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">N1=<span class="number">60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868190554644983911078936369464590301246394586190666760362763580192139772729890492729488892169933099057105842090125200369295070365451134781912223048179092058016446222199742919885472867511334714233086339832790286482634562102936600597781342756061479024744312357407750731307860842457299116947352106025529309727703385914891200109853084742321655388368371397596144557614128458065859276522963419738435137978069417053712567764148183279165963454266011754149684758060746773409666706463583389316772088889398359242197165140562147489286818190852679930372669254697353483887004105934649944725189954685412228899457155711301864163839538810653626724347</span></span><br><span class="line">c1=<span class="number">55094296873556883585060020895253176070835143350249581136609315815308788255684072804968957510292559743192424646169207794748893753882418256401223641287546922358162629295622258913168323493447075410872354874300793298956869374606043622559405978242734950156459436487837698668489891733875650048466360950142617732135781244969524095348835624828008115829566644654403962285001724209210887446203934276651265377137788183939798543755386888532680013170540716736656670269251318800501517579803401154996881233025210176293554542024052540093890387437964747460765498713092018160196637928204190194154199389276666685436565665236397481709703644555328705818892269499380797044554054118656321389474821224725533693520856047736578402581854165941599254178019515615183102894716647680969742744705218868455450832</span></span><br><span class="line">E1=<span class="number">125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820423103</span></span><br><span class="line">N2=<span class="number">60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868195633647431732875392121458684331843306730889424418620069322578265236351407591029338519809538995249896905137642342435659572917714183543305243715664380787797562011006398730320980994747939791561885622949912698246701769321430325902912003041678774440704056597862093530981040696872522868921139041247362592257285423948870944137019745161211585845927019259709501237550818918272189606436413992759328318871765171844153527424347985462767028135376552302463861324408178183842139330244906606776359050482977256728910278687996106152971028878653123533559760167711270265171441623056873903669918694259043580017081671349232051870716493557434517579121</span></span><br><span class="line">c2=<span class="number">39328446140156257571484184713861319722905864197556720730852773059147902283123252767651430278357950872626778348596897711320942449693270603776870301102881405303651558719085454281142395652056217241751656631812580544180434349840236919765433122389116860827593711593732385562328255759509355298662361508611531972386995239908513273236239858854586845849686865360780290350287139092143587037396801704351692736985955152935601987758859759421886670907735120137698039900161327397951758852875291442188850946273771733011504922325622240838288097946309825051094566685479503461938502373520983684296658971700922069426788236476575236189040102848418547634290214175167767431475003216056701094275899211419979340802711684989710130215926526387138538819531199810841475218142606691152928236362534181622201347</span></span><br><span class="line">E2=<span class="number">125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820425393</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    cF = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cF += [x // y]</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cF</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Simplify</span>(<span class="params">ctnf</span>):</span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> ctnf[::-<span class="number">1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> (numerator, denominator)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getit</span>(<span class="params">c</span>):</span><br><span class="line">    cf=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(c)):</span><br><span class="line">        cf.append(Simplify(c[:i]))</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"><span class="comment">#求渐进分数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    cf=continuedFra(e,n)</span><br><span class="line">    <span class="keyword">for</span> (p2,p1) <span class="keyword">in</span> getit(cf):</span><br><span class="line">        <span class="keyword">if</span> p1 == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> N1%p1==<span class="number">0</span> <span class="keyword">and</span> p1!=<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> p1</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;not find!&#x27;</span>)</span><br><span class="line">q1=wienerAttack(N1,N2)</span><br><span class="line"><span class="comment">#p1=11628371843051760370952910026406764366191062991235308941262037248377376991693250742343307155422036713746576338866595433599862614339347536916226536644210947</span></span><br><span class="line"><span class="built_in">print</span>(q1)</span><br><span class="line">p1=gmpy2.iroot(N1//q1,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p2=gmpy2.next_prime(p1)</span><br><span class="line">q2=gmpy2.next_prime(q1)</span><br><span class="line">phi1=p1*(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">phi2=p2*(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d1=gmpy2.invert(E1,phi1)</span><br><span class="line">d2=gmpy2.invert(E2,phi2)</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line">m1=number.long_to_bytes(gmpy2.powmod(c1,d1,N1))</span><br><span class="line">m2=number.long_to_bytes(gmpy2.powmod(c2,d2,N2))</span><br><span class="line"><span class="built_in">print</span>((m1+m2))</span><br><span class="line"></span><br><span class="line"><span class="comment">#GWHT&#123;3aadab41754799f978669d53e64a3aca&#125;</span></span><br></pre></td></tr></table></figure><p>【参考资料】</p><p><a href="http://t.csdnimg.cn/HzyzT">http://t.csdnimg.cn/HzyzT</a></p><p><a href="http://t.csdnimg.cn/BRvWy">http://t.csdnimg.cn/BRvWy</a></p><p><a href="http://t.csdnimg.cn/m9L8j">http://t.csdnimg.cn/m9L8j</a></p><p>后面还有羊城杯的22年、23年相关真题，有时间再分析</p><p><a href="http://t.csdnimg.cn/OvTUm">http://t.csdnimg.cn/OvTUm</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 维纳攻击 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k-means聚类算法</title>
      <link href="/2023/08/24/k-jun-zhi-ju-lei-suan-fa/"/>
      <url>/2023/08/24/k-jun-zhi-ju-lei-suan-fa/</url>
      
        <content type="html"><![CDATA[<h2 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a>一、介绍</h2><p>K-means聚类算法是先随机选取K个对象作为初始的聚类中心。然后计算每个对象与各个种子聚类中心之间的距离，把每个对象分配给距离它最近的聚类中心。聚类中心以及分配给它们的对象就代表一个聚类。每分配一个样本，聚类的聚类中心会根据聚类中现有的对象被重新计算。这个过程将不断重复直到满足某个终止条件。终止条件可以是没有（或最小数目）对象被重新分配给不同的聚类，没有（或最小数目）聚类中心再发生变化，误差平方和局部最小。</p><h2 id="二、简化实例"><a href="#二、简化实例" class="headerlink" title="二、简化实例"></a>二、简化实例</h2><p>1.便于理解，首先创建一个明显分为2类20*2的例子（每一列为一个变量共2个变量，每一行为一个样本共20个样本）：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">c1x=np.random.uniform(<span class="number">0.5</span>,<span class="number">1.5</span>,(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line">c1y=np.random.uniform(<span class="number">0.5</span>,<span class="number">1.5</span>,(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line">c2x=np.random.uniform(<span class="number">3.5</span>,<span class="number">4.5</span>,(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line">c2y=np.random.uniform(<span class="number">3.5</span>,<span class="number">4.5</span>,(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line">x=np.hstack((c1x,c2x))</span><br><span class="line">y=np.hstack((c2y,c2y))</span><br><span class="line">X=np.vstack((x,y)).T</span><br><span class="line">print(X)</span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>结果如下：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">1.4889993</span>  <span class="number">4.18741329</span>]</span><br><span class="line"> [<span class="number">0.73017615</span> <span class="number">4.07842216</span>]</span><br><span class="line"> [<span class="number">1.15522846</span> <span class="number">4.05744838</span>]</span><br><span class="line"> [<span class="number">1.40768457</span> <span class="number">3.76674812</span>]</span><br><span class="line"> [<span class="number">1.376212</span>   <span class="number">3.95063903</span>]</span><br><span class="line"> [<span class="number">1.20821055</span> <span class="number">4.34138767</span>]</span><br><span class="line"> [<span class="number">0.73898392</span> <span class="number">3.55026013</span>]</span><br><span class="line"> [<span class="number">0.97116627</span> <span class="number">3.65432314</span>]</span><br><span class="line"> [<span class="number">0.98267302</span> <span class="number">4.16731561</span>]</span><br><span class="line"> [<span class="number">1.06346541</span> <span class="number">4.44383585</span>]</span><br><span class="line"> [<span class="number">4.10945954</span> <span class="number">4.18741329</span>]</span><br><span class="line"> [<span class="number">3.75288064</span> <span class="number">4.07842216</span>]</span><br><span class="line"> [<span class="number">4.29638229</span> <span class="number">4.05744838</span>]</span><br><span class="line"> [<span class="number">3.95221785</span> <span class="number">3.76674812</span>]</span><br><span class="line"> [<span class="number">4.09826192</span> <span class="number">3.95063903</span>]</span><br><span class="line"> [<span class="number">4.04840874</span> <span class="number">4.34138767</span>]</span><br><span class="line"> [<span class="number">4.29594009</span> <span class="number">3.55026013</span>]</span><br><span class="line"> [<span class="number">3.56931245</span> <span class="number">3.65432314</span>]</span><br><span class="line"> [<span class="number">3.57962941</span> <span class="number">4.16731561</span>]</span><br><span class="line"> [<span class="number">3.65208848</span> <span class="number">4.44383585</span>]]</span><br></pre></td></tr></table></figure><p>2.引用Python库将样本分为两类（k&#x3D;2），并绘制散点图：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#只需将X修改即可进行其他聚类分析</span></span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">from sklearn.cluster import <span class="title class_">KMeans</span></span><br><span class="line"> </span><br><span class="line">kemans=<span class="title class_">KMeans</span>(n_clusters=<span class="number">2</span>)</span><br><span class="line">result=kemans.fit_predict(X) <span class="comment">#训练及预测</span></span><br><span class="line">print(result)   <span class="comment">#分类结果</span></span><br><span class="line"> </span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>] = [<span class="string">&#x27;sans-serif&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment">#散点图标签可以显示中文</span></span><br><span class="line"> </span><br><span class="line">x=[i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> X]</span><br><span class="line">y=[i[<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> X]</span><br><span class="line">plt.scatter(x,y,c=result,marker=<span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>结果如下：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>3.如果K值未知，可采用肘部法选择K值（假设最大分类数为9类，分别计算分类结果为1-9类的平均离差，离差的提升变化下降最抖时的值为最优聚类数K）：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">from sklearn.cluster import <span class="title class_">KMeans</span></span><br><span class="line">from scipy.spatial.distance import cdist</span><br><span class="line"> </span><br><span class="line">K=range(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">meanDispersions=[]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="symbol">K:</span></span><br><span class="line">    kemans=<span class="title class_">KMeans</span>(n_clusters=k)</span><br><span class="line">    kemans.fit(X)</span><br><span class="line">    <span class="comment">#计算平均离差</span></span><br><span class="line">    m_Disp=sum(np.min(cdist(X,kemans.cluster_centers_,<span class="string">&#x27;euclidean&#x27;</span>),axis=<span class="number">1</span>))/X.shape[<span class="number">0</span>]</span><br><span class="line">    meanDispersions.append(m_Disp)</span><br><span class="line"> </span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>] = [<span class="string">&#x27;sans-serif&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment">#使折线图显示中文</span></span><br><span class="line"> </span><br><span class="line">plt.plot(K,meanDispersions,<span class="string">&#x27;bx-&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;平均离差&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;用肘部方法选择K值&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><h2 id="三、实例分析（对某网站500家饭店价格及评论进行聚类）"><a href="#三、实例分析（对某网站500家饭店价格及评论进行聚类）" class="headerlink" title="三、实例分析（对某网站500家饭店价格及评论进行聚类）"></a>三、实例分析（对某网站500家饭店价格及评论进行聚类）</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from sklearn.cluster import <span class="title class_">KMeans</span></span><br><span class="line">from scipy.spatial.distance import cdist</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import pandas as pd</span><br><span class="line"> </span><br><span class="line">data=pd.read_excel(<span class="string">&#x27;data.xlsx&#x27;</span>,header=<span class="number">0</span>).iloc[<span class="symbol">:</span><span class="number">501</span>,<span class="number">3</span><span class="symbol">:</span><span class="number">5</span>]</span><br><span class="line">per_25=data.describe().iloc[<span class="number">4</span>,<span class="number">1</span>]</span><br><span class="line">per_75=data.describe().iloc[<span class="number">6</span>,<span class="number">1</span>]</span><br><span class="line">data=data[(data.iloc[<span class="symbol">:</span>,<span class="number">1</span>]&gt;=per_25)&amp;(data.iloc[<span class="symbol">:</span>,<span class="number">1</span>]&lt;=per_75)] <span class="comment">#选择位于四分位数之内的数</span></span><br><span class="line">X=np.array(data)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">K=range(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">meanDispersions=[]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="symbol">K:</span></span><br><span class="line">    kemans=<span class="title class_">KMeans</span>(n_clusters=k)</span><br><span class="line">    kemans.fit(X)</span><br><span class="line">    meanDispersions.append(sum(np.min(cdist(X,kemans.cluster_centers_,<span class="string">&#x27;euclidean&#x27;</span>),axis=<span class="number">1</span>))/X.shape[<span class="number">0</span>])</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>] = [<span class="string">&#x27;sans-serif&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">plt.plot(K,meanDispersions,<span class="string">&#x27;bx-&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;平均离差&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;用肘部方法选择K值&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>具体聚类过程：<br> <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.cluster import <span class="title class_">KMeans</span></span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"> </span><br><span class="line">kemans=<span class="title class_">KMeans</span>(n_clusters=<span class="number">3</span>)</span><br><span class="line">result=kemans.fit_predict(X)</span><br><span class="line">print(result)</span><br><span class="line">x=[i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> X]</span><br><span class="line">y=[i[<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> X]</span><br><span class="line">plt.scatter(x,y,c=result,marker=<span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;avgPrice&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;llCommentNum&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;对500家饭店价格与评论数进行聚类&#x27;</span>)</span><br></pre></td></tr></table></figure><br>聚类结果：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line"> <span class="number">2</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">2</span> <span class="number">0</span> <span class="number">2</span> <span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">0</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line"> <span class="number">0</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line"> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line"> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">0</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>] </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数模 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/08/30/hello-world/"/>
      <url>/2022/08/30/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
